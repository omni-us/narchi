

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Reference &mdash; narchi 1.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Command line tool" href="cmd.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> narchi
          

          
          </a>

          
            
            
              <div class="version">
                1.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="schema.html">Json Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmd.html">Command line tool</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.blocks">narchi.blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.graph">narchi.graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.module">narchi.module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.render">narchi.render</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.schemas">narchi.schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.sympy">narchi.sympy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.base">narchi.propagators.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.concat">narchi.propagators.concat</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.conv">narchi.propagators.conv</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.fixed">narchi.propagators.fixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.group">narchi.propagators.group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.reshape">narchi.propagators.reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.rnn">narchi.propagators.rnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.propagators.same">narchi.propagators.same</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.instantiators.common">narchi.instantiators.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.instantiators.pytorch">narchi.instantiators.pytorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-narchi.instantiators.pytorch_packed">narchi.instantiators.pytorch_packed</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">narchi</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-narchi.blocks">
<span id="narchi-blocks"></span><h2>narchi.blocks<a class="headerlink" href="#module-narchi.blocks" title="Permalink to this headline">¶</a></h2>
<p>Blocks definitions and functions related to registering propagators.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">AddFixedPropagator</span></code>(block_class[, fixed_dims])</p></td>
<td><p>Propagator for blocks that adds fixed dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ConcatBlocksEnum" title="narchi.blocks.ConcatBlocksEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConcatBlocksEnum</span></code></a>(value)</p></td>
<td><p>Enum of blocks that concatenate multiple inputs.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConcatenatePropagator</span></code>(block_class)</p></td>
<td><p>Propagator for concatenating along a given dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum" title="narchi.blocks.ConvBlocksEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConvBlocksEnum</span></code></a>(value)</p></td>
<td><p>Enum of convolution-style blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConvPropagator</span></code>(block_class, conv_dims)</p></td>
<td><p>Propagator for convolution style blocks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.FixedOutputBlocksEnum" title="narchi.blocks.FixedOutputBlocksEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedOutputBlocksEnum</span></code></a>(value)</p></td>
<td><p>Enum of blocks that have fixed outputs.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedOutputPropagator</span></code>(block_class[, …])</p></td>
<td><p>Propagator for fixed output size blocks.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">GroupPropagator</span></code>(block_class)</p></td>
<td><p>Propagator for a sequence of blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.GroupPropagatorsEnum" title="narchi.blocks.GroupPropagatorsEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GroupPropagatorsEnum</span></code></a>(value)</p></td>
<td><p>Enum of blocks that group other blocks.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModulePropagator</span></code>(block_class)</p></td>
<td><p>Propagator for complete modules.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">PoolPropagator</span></code>(block_class, conv_dims)</p></td>
<td><p>Propagator for pooling style blocks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ReshapeBlocksEnum" title="narchi.blocks.ReshapeBlocksEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReshapeBlocksEnum</span></code></a>(value)</p></td>
<td><p>Enum of blocks that transform the shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReshapePropagator</span></code>(block_class)</p></td>
<td><p>Propagator for reshapping which could involve any of: permute, flatten and unflatten.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.RnnBlocksEnum" title="narchi.blocks.RnnBlocksEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RnnBlocksEnum</span></code></a>(value)</p></td>
<td><p>Enum of recurrent-style blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RnnPropagator</span></code>(block_class)</p></td>
<td><p>Propagator for recurrent style blocks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum" title="narchi.blocks.SameShapeBlocksEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapeBlocksEnum</span></code></a>(value)</p></td>
<td><p>Enum of blocks that preserve the input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapeConsumeDimPropagator</span></code>(block_class)</p></td>
<td><p>Propagator for blocks in which the output shape is the same as input except the last which is consumed.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapePropagator</span></code>(block_class)</p></td>
<td><p>Propagator for blocks in which the input and output shapes are the same.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapesPropagator</span></code>(block_class)</p></td>
<td><p>Propagator for blocks that receive multiple inputs of the same shape and preserves this shape.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SequentialPropagator</span></code>(block_class)</p></td>
<td><p>Propagator for a sequence of blocks.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.register_known_propagators" title="narchi.blocks.register_known_propagators"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_known_propagators</span></code></a>()</p></td>
<td><p>Function that registers all propagators defined in the modules of the package.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.register_propagator" title="narchi.blocks.register_propagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_propagator</span></code></a>(propagator[, replace])</p></td>
<td><p>Adds a propagator to the dictionary of registered propagators.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.blocks.SameShapeBlocksEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">SameShapeBlocksEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#SameShapeBlocksEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of blocks that preserve the input shape.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.Sigmoid" title="narchi.blocks.SameShapeBlocksEnum.Sigmoid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sigmoid</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that applies a sigmoid function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.LogSigmoid" title="narchi.blocks.SameShapeBlocksEnum.LogSigmoid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LogSigmoid</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>Block that applies a log-sigmoid function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.Softmax" title="narchi.blocks.SameShapeBlocksEnum.Softmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Softmax</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that applies a softmax function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.LogSoftmax" title="narchi.blocks.SameShapeBlocksEnum.LogSoftmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LogSoftmax</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>Block that applies a log-softmax function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.Tanh" title="narchi.blocks.SameShapeBlocksEnum.Tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tanh</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that applies a hyperbolic tangent function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.ReLU" title="narchi.blocks.SameShapeBlocksEnum.ReLU"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReLU</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that applies a rectified linear unit function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.LeakyReLU" title="narchi.blocks.SameShapeBlocksEnum.LeakyReLU"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LeakyReLU</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that applies a leaky rectified linear unit function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.Dropout" title="narchi.blocks.SameShapeBlocksEnum.Dropout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dropout</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that applies dropout, randomly set elements to zero.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.BatchNorm2d" title="narchi.blocks.SameShapeBlocksEnum.BatchNorm2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BatchNorm2d</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>Block that does 2D batch normalization.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.Identity" title="narchi.blocks.SameShapeBlocksEnum.Identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Identity</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that does nothing, useful to connect one tensor to multiple blocks in a graph.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.Add" title="narchi.blocks.SameShapeBlocksEnum.Add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Add</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Block that adds the values of all input tensors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.SameShapeBlocksEnum.CRF" title="narchi.blocks.SameShapeBlocksEnum.CRF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CRF</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>A layer that performs CRF decoding.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.Sigmoid">
<code class="sig-name descname">Sigmoid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.Sigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a sigmoid function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.LogSigmoid">
<code class="sig-name descname">LogSigmoid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.LogSigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a log-sigmoid function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.Softmax">
<code class="sig-name descname">Softmax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.Softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a softmax function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.LogSoftmax">
<code class="sig-name descname">LogSoftmax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.LogSoftmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a log-softmax function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.Tanh">
<code class="sig-name descname">Tanh</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.Tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a hyperbolic tangent function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.ReLU">
<code class="sig-name descname">ReLU</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.ReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a rectified linear unit function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.LeakyReLU">
<code class="sig-name descname">LeakyReLU</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.LeakyReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies a leaky rectified linear unit function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.Dropout">
<code class="sig-name descname">Dropout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.Dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that applies dropout, randomly set elements to zero.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.BatchNorm2d">
<code class="sig-name descname">BatchNorm2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.BatchNorm2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that does 2D batch normalization.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.Identity">
<code class="sig-name descname">Identity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that does nothing, useful to connect one tensor to multiple blocks in a graph.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.Add">
<code class="sig-name descname">Add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapesPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.Add" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that adds the values of all input tensors. Input tensors must have the same shape.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.SameShapeBlocksEnum.CRF">
<code class="sig-name descname">CRF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.same.SameShapeConsumeDimPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.SameShapeBlocksEnum.CRF" title="Permalink to this definition">¶</a></dt>
<dd><p>A layer that performs CRF decoding.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.blocks.ConcatBlocksEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">ConcatBlocksEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#ConcatBlocksEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.ConcatBlocksEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of blocks that concatenate multiple inputs.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ConcatBlocksEnum.Concatenate" title="narchi.blocks.ConcatBlocksEnum.Concatenate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Concatenate</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>Block that concatenates multiple inputs of the same shape along a given dimension.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.ConcatBlocksEnum.Concatenate">
<code class="sig-name descname">Concatenate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.concat.ConcatenatePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConcatBlocksEnum.Concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Block that concatenates multiple inputs of the same shape along a given dimension.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.blocks.FixedOutputBlocksEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">FixedOutputBlocksEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#FixedOutputBlocksEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.FixedOutputBlocksEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of blocks that have fixed outputs.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.FixedOutputBlocksEnum.Linear" title="narchi.blocks.FixedOutputBlocksEnum.Linear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Linear</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Linear transformation to the last dimension of input tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.FixedOutputBlocksEnum.Embedding" title="narchi.blocks.FixedOutputBlocksEnum.Embedding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Embedding</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>A lookup table that retrieves embeddings of a fixed size.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool1d" title="narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AdaptiveAvgPool1d</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>1D adaptive average pooling over input.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool2d" title="narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AdaptiveAvgPool2d</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>2D adaptive average pooling over input.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.FixedOutputBlocksEnum.Linear">
<code class="sig-name descname">Linear</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.fixed.FixedOutputPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.FixedOutputBlocksEnum.Linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear transformation to the last dimension of input tensor.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.FixedOutputBlocksEnum.Embedding">
<code class="sig-name descname">Embedding</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.fixed.AddFixedPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.FixedOutputBlocksEnum.Embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>A lookup table that retrieves embeddings of a fixed size.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool1d">
<code class="sig-name descname">AdaptiveAvgPool1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.fixed.FixedOutputPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool1d" title="Permalink to this definition">¶</a></dt>
<dd><p>1D adaptive average pooling over input.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool2d">
<code class="sig-name descname">AdaptiveAvgPool2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.fixed.FixedOutputPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.FixedOutputBlocksEnum.AdaptiveAvgPool2d" title="Permalink to this definition">¶</a></dt>
<dd><p>2D adaptive average pooling over input.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.blocks.ConvBlocksEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">ConvBlocksEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#ConvBlocksEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of convolution-style blocks.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.Conv1d" title="narchi.blocks.ConvBlocksEnum.Conv1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Conv1d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>1D convolution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.Conv2d" title="narchi.blocks.ConvBlocksEnum.Conv2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Conv2d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>2D convolution.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.Conv3d" title="narchi.blocks.ConvBlocksEnum.Conv3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Conv3d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>3D convolution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.MaxPool1d" title="narchi.blocks.ConvBlocksEnum.MaxPool1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MaxPool1d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>1D maximum pooling.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.MaxPool2d" title="narchi.blocks.ConvBlocksEnum.MaxPool2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MaxPool2d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>2D maximum pooling.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.MaxPool3d" title="narchi.blocks.ConvBlocksEnum.MaxPool3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MaxPool3d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>3D maximum pooling.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.AvgPool1d" title="narchi.blocks.ConvBlocksEnum.AvgPool1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AvgPool1d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>1D average pooling.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.AvgPool2d" title="narchi.blocks.ConvBlocksEnum.AvgPool2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AvgPool2d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>2D average pooling.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ConvBlocksEnum.AvgPool3d" title="narchi.blocks.ConvBlocksEnum.AvgPool3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AvgPool3d</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>3D average pooling.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.Conv1d">
<code class="sig-name descname">Conv1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.ConvPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.Conv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>1D convolution.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.Conv2d">
<code class="sig-name descname">Conv2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.ConvPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.Conv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>2D convolution.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.Conv3d">
<code class="sig-name descname">Conv3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.ConvPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.Conv3d" title="Permalink to this definition">¶</a></dt>
<dd><p>3D convolution.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.MaxPool1d">
<code class="sig-name descname">MaxPool1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.PoolPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.MaxPool1d" title="Permalink to this definition">¶</a></dt>
<dd><p>1D maximum pooling.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.MaxPool2d">
<code class="sig-name descname">MaxPool2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.PoolPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.MaxPool2d" title="Permalink to this definition">¶</a></dt>
<dd><p>2D maximum pooling.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.MaxPool3d">
<code class="sig-name descname">MaxPool3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.PoolPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.MaxPool3d" title="Permalink to this definition">¶</a></dt>
<dd><p>3D maximum pooling.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.AvgPool1d">
<code class="sig-name descname">AvgPool1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.PoolPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.AvgPool1d" title="Permalink to this definition">¶</a></dt>
<dd><p>1D average pooling.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.AvgPool2d">
<code class="sig-name descname">AvgPool2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.PoolPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.AvgPool2d" title="Permalink to this definition">¶</a></dt>
<dd><p>2D average pooling.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.ConvBlocksEnum.AvgPool3d">
<code class="sig-name descname">AvgPool3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.conv.PoolPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ConvBlocksEnum.AvgPool3d" title="Permalink to this definition">¶</a></dt>
<dd><p>3D average pooling.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.blocks.RnnBlocksEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">RnnBlocksEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#RnnBlocksEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.RnnBlocksEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of recurrent-style blocks.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.RnnBlocksEnum.RNN" title="narchi.blocks.RnnBlocksEnum.RNN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RNN</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>A simple recurrent block.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.RnnBlocksEnum.LSTM" title="narchi.blocks.RnnBlocksEnum.LSTM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LSTM</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>An LSTM recurrent block.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.RnnBlocksEnum.GRU" title="narchi.blocks.RnnBlocksEnum.GRU"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GRU</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>A GRU recurrent block.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.RnnBlocksEnum.RNN">
<code class="sig-name descname">RNN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.rnn.RnnPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.RnnBlocksEnum.RNN" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple recurrent block.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.RnnBlocksEnum.LSTM">
<code class="sig-name descname">LSTM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.rnn.RnnPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.RnnBlocksEnum.LSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>An LSTM recurrent block.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.RnnBlocksEnum.GRU">
<code class="sig-name descname">GRU</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.rnn.RnnPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.RnnBlocksEnum.GRU" title="Permalink to this definition">¶</a></dt>
<dd><p>A GRU recurrent block.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.blocks.ReshapeBlocksEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">ReshapeBlocksEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#ReshapeBlocksEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.ReshapeBlocksEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of blocks that transform the shape.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.ReshapeBlocksEnum.Reshape" title="narchi.blocks.ReshapeBlocksEnum.Reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Reshape</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Transformation of the shape of the input.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.ReshapeBlocksEnum.Reshape">
<code class="sig-name descname">Reshape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.reshape.ReshapePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.ReshapeBlocksEnum.Reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation of the shape of the input.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.blocks.GroupPropagatorsEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">GroupPropagatorsEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#GroupPropagatorsEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.GroupPropagatorsEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of blocks that group other blocks.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.GroupPropagatorsEnum.Sequential" title="narchi.blocks.GroupPropagatorsEnum.Sequential"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sequential</span></code></a>(from_blocks, block[, …])</p></td>
<td><p>Sequence of blocks that are connected in the given order.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.blocks.GroupPropagatorsEnum.Group" title="narchi.blocks.GroupPropagatorsEnum.Group"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Group</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Group of blocks with connected according to a given graph.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.blocks.GroupPropagatorsEnum.Module" title="narchi.blocks.GroupPropagatorsEnum.Module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Definition of a complete module.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.blocks.GroupPropagatorsEnum.Sequential">
<code class="sig-name descname">Sequential</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.group.SequentialPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.GroupPropagatorsEnum.Sequential" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence of blocks that are connected in the given order.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.GroupPropagatorsEnum.Group">
<code class="sig-name descname">Group</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.propagators.group.GroupPropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.GroupPropagatorsEnum.Group" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of blocks with connected according to a given graph.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.blocks.GroupPropagatorsEnum.Module">
<code class="sig-name descname">Module</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><em class="property"> = &lt;narchi.module.ModulePropagator object&gt;</em><a class="headerlink" href="#narchi.blocks.GroupPropagatorsEnum.Module" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of a complete module.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="narchi.blocks.register_propagator">
<code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">register_propagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">propagator</span></em>, <em class="sig-param"><span class="n">replace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#register_propagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.register_propagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a propagator to the dictionary of registered propagators.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.blocks.register_known_propagators">
<code class="sig-prename descclassname">narchi.blocks.</code><code class="sig-name descname">register_known_propagators</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/blocks.html#register_known_propagators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.blocks.register_known_propagators" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that registers all propagators defined in the modules of the package.</p>
</dd></dl>

</div>
<div class="section" id="module-narchi.graph">
<span id="narchi-graph"></span><h2>narchi.graph<a class="headerlink" href="#module-narchi.graph" title="Permalink to this headline">¶</a></h2>
<p>Functions related to the parsing of graphs.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">AGraph</span></code>([thing, filename, data, string, …])</p></td>
<td><p>Class for Graphviz agraph type.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">OrderedDict</span></code></p></td>
<td><p>Dictionary that remembers insertion order</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict_to_namespace</span></code>(cfg_dict)</p></td>
<td><p>Converts a nested dictionary into a nested namespace.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_agraph</span></code>(A[, create_using])</p></td>
<td><p>Returns a NetworkX Graph or DiGraph from a PyGraphviz graph.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_directed_acyclic_graph</span></code>(G)</p></td>
<td><p>Returns True if the graph <cite>G</cite> is a directed acyclic graph (DAG) or False if not.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.graph.parse_graph" title="narchi.graph.parse_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_graph</span></code></a>(from_blocks, block)</p></td>
<td><p>Parses a graph of a block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">topological_sort</span></code>(G)</p></td>
<td><p>Returns a generator of nodes in topologically sorted order.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="narchi.graph.parse_graph">
<code class="sig-prename descclassname">narchi.graph.</code><code class="sig-name descname">parse_graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/graph.html#parse_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.graph.parse_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a graph of a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to parse its graph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary in topological order mapping                                      node IDs to its respective input nodes IDs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>OrderedDict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>]]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If there are problems parsing the graph.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the graph is not directed and acyclic.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If topological sort does not include all nodes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-narchi.module">
<span id="narchi-module"></span><h2>narchi.module<a class="headerlink" href="#module-narchi.module" title="Permalink to this headline">¶</a></h2>
<p>Classes related to neural network module architectures.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActionConfigFile</span></code>(**kwargs)</p></td>
<td><p>Action to indicate that an argument is a configuration file or a configuration string.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActionJsonnet</span></code>(**kwargs)</p></td>
<td><p>Action to parse a jsonnet, optionally validating against a jsonschema.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActionJsonnetExtVars</span></code>(**kwargs)</p></td>
<td><p>Action to add argument to provide ext_vars for jsonnet parsing.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActionPath</span></code>(**kwargs)</p></td>
<td><p>Action to check and store a path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ArgumentParser</span></code>(*args, env_prefix, …)</p></td>
<td><p>Parser for command line, yaml/jsonnet files and environment variables.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture" title="narchi.module.ModuleArchitecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModuleArchitecture</span></code></a>([architecture, cfg, parser])</p></td>
<td><p>Class for instantiating ModuleArchitecture objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModulePropagator" title="narchi.module.ModulePropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModulePropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for complete modules.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Namespace</span></code>(**kwargs)</p></td>
<td><p>Simple object for storing attributes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Path</span></code>(path, Path], mode, cwd, skip_check)</p></td>
<td><p>Stores a (possibly relative) path and the corresponding absolute path.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ids_prefix</span></code>(block, io_blocks[, skip_io])</p></td>
<td><p>Adds to block id a prefix consisting of parent id and separator as defined in propagated schema.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code>(x[, memo, _nil])</p></td>
<td><p>Deep copy operation on arbitrary Python objects.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_blocks_dict</span></code>(blocks)</p></td>
<td><p>Function that creates a dictionary of blocks using _id as keys.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config_read_mode</span></code>()</p></td>
<td><p>Returns the current config reading mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">import_object</span></code>(name)</p></td>
<td><p>Function that returns a class in a module given its dot import statement.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">namespace_to_dict</span></code>(cfg_ns)</p></td>
<td><p>Converts a nested namespace into a nested dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_graph</span></code>(from_blocks, block)</p></td>
<td><p>Parses a graph of a block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate_shapes</span></code>(blocks_dict, …[, skip_ids])</p></td>
<td><p>Function that propagates shapes in blocks based on a connections mapping.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">shapes_agree</span></code>(shape_from, shape_to)</p></td>
<td><p>Checks whether the output shape from a block agrees with input shape of another block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympify_variable</span></code>(value)</p></td>
<td><p>Returns the sympyfied object for the given value.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.module.ModuleArchitecture">
<em class="property">class </em><code class="sig-prename descclassname">narchi.module.</code><code class="sig-name descname">ModuleArchitecture</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">architecture</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cfg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parser</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for instantiating ModuleArchitecture objects.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.__init__" title="narchi.module.ModuleArchitecture.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>([architecture, cfg, parser])</p></td>
<td><p>Initializer for ModuleArchitecture class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.apply_config" title="narchi.module.ModuleArchitecture.apply_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_config</span></code></a>(cfg)</p></td>
<td><p>Applies a configuration to the ModuleArchitecture instance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.get_config_parser" title="narchi.module.ModuleArchitecture.get_config_parser"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config_parser</span></code></a>()</p></td>
<td><p>Returns a ModuleArchitecture configuration parser.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.load_architecture" title="narchi.module.ModuleArchitecture.load_architecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_architecture</span></code></a>(architecture)</p></td>
<td><p>Loads an architecture file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.propagate" title="narchi.module.ModuleArchitecture.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>()</p></td>
<td><p>Propagates the shapes of the neural network module architecture.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.validate" title="narchi.module.ModuleArchitecture.validate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate</span></code></a>()</p></td>
<td><p>Validates the architecture against the narchi or propagated schema.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.write_json" title="narchi.module.ModuleArchitecture.write_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_json</span></code></a>(json_path)</p></td>
<td><p>Writes the current state of the architecture in json format to the given path.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.write_json_outdir" title="narchi.module.ModuleArchitecture.write_json_outdir"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_json_outdir</span></code></a>()</p></td>
<td><p>Writes the current state of the architecture in to the configured output directory.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.architecture" title="narchi.module.ModuleArchitecture.architecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">architecture</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.blocks" title="narchi.module.ModuleArchitecture.blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.jsonnet" title="narchi.module.ModuleArchitecture.jsonnet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jsonnet</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.path" title="narchi.module.ModuleArchitecture.path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.propagators" title="narchi.module.ModuleArchitecture.propagators"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagators</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModuleArchitecture.topological_predecessors" title="narchi.module.ModuleArchitecture.topological_predecessors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">topological_predecessors</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.module.ModuleArchitecture.path">
<code class="sig-name descname">path</code><em class="property"> = None</em><a class="headerlink" href="#narchi.module.ModuleArchitecture.path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.module.ModuleArchitecture.jsonnet">
<code class="sig-name descname">jsonnet</code><em class="property"> = None</em><a class="headerlink" href="#narchi.module.ModuleArchitecture.jsonnet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.module.ModuleArchitecture.architecture">
<code class="sig-name descname">architecture</code><em class="property"> = None</em><a class="headerlink" href="#narchi.module.ModuleArchitecture.architecture" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.module.ModuleArchitecture.propagators">
<code class="sig-name descname">propagators</code><em class="property"> = 'default'</em><a class="headerlink" href="#narchi.module.ModuleArchitecture.propagators" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.module.ModuleArchitecture.blocks">
<code class="sig-name descname">blocks</code><em class="property"> = None</em><a class="headerlink" href="#narchi.module.ModuleArchitecture.blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.module.ModuleArchitecture.topological_predecessors">
<code class="sig-name descname">topological_predecessors</code><em class="property"> = None</em><a class="headerlink" href="#narchi.module.ModuleArchitecture.topological_predecessors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.get_config_parser">
<em class="property">static </em><code class="sig-name descname">get_config_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.get_config_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.get_config_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a ModuleArchitecture configuration parser.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">architecture</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cfg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parser</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for ModuleArchitecture class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>architecture</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>Path</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Path to a jsonnet architecture file.</p></li>
<li><p><strong>cfg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><em>Namespace</em>) – Path to config file or config object.</p></li>
<li><p><strong>parser</strong> (<em>jsonargparse.ArgumentParser</em>) – Parser object in case it is an extension of get_config_parser().</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.apply_config">
<code class="sig-name descname">apply_config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cfg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.apply_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.apply_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a configuration to the ModuleArchitecture instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cfg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><em>Namespace</em>) – Path to config file or config object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.load_architecture">
<code class="sig-name descname">load_architecture</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">architecture</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.load_architecture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.load_architecture" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads an architecture file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>architecture</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>Path</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Path to a jsonnet architecture file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates the architecture against the narchi or propagated schema.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates the shapes of the neural network module architecture.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.write_json">
<code class="sig-name descname">write_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">json_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.write_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.write_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current state of the architecture in json format to the given path.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModuleArchitecture.write_json_outdir">
<code class="sig-name descname">write_json_outdir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModuleArchitecture.write_json_outdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModuleArchitecture.write_json_outdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current state of the architecture in to the configured output directory.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.module.ModulePropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.module.</code><code class="sig-name descname">ModulePropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModulePropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModulePropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for complete modules.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModulePropagator.connect_input" title="narchi.module.ModulePropagator.connect_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_input</span></code></a>(from_blocks, block, module)</p></td>
<td><p>Checks fixed dimensions agree and replaces the modules’s variable dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.module.ModulePropagator.propagate" title="narchi.module.ModulePropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Method that propagates shapes through a module.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.module.ModulePropagator.num_input_blocks" title="narchi.module.ModulePropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.module.ModulePropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.module.ModulePropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.module.ModulePropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModulePropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModulePropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes through a module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
<li><p><strong>propagators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of propagators.</p></li>
<li><p><strong>ext_vars</strong> (<em>Namespace</em>) – External variables required to load jsonnet.</p></li>
<li><p><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Working directory to resolve relative paths.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If no propagator found for some block.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.module.ModulePropagator.connect_input">
<em class="property">static </em><code class="sig-name descname">connect_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">module</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/module.html#ModulePropagator.connect_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.module.ModulePropagator.connect_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks fixed dimensions agree and replaces the modules’s variable dimensions.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.render">
<span id="narchi-render"></span><h2>narchi.render<a class="headerlink" href="#module-narchi.render" title="Permalink to this headline">¶</a></h2>
<p>Classes related to rendering of architectures.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">AGraph</span></code>([thing, filename, data, string, …])</p></td>
<td><p>Class for Graphviz agraph type.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActionJsonSchema</span></code>(**kwargs)</p></td>
<td><p>Action to parse option as json validated by a jsonschema.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActionOperators</span></code>(**kwargs)</p></td>
<td><p>DEPRECATED: Action to restrict a value with comparison operators.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModuleArchitecture</span></code>([architecture, cfg, parser])</p></td>
<td><p>Class for instantiating ModuleArchitecture objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.render.ModuleArchitectureRenderer" title="narchi.render.ModuleArchitectureRenderer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModuleArchitectureRenderer</span></code></a>([architecture, …])</p></td>
<td><p>Class for instantiating a ModuleArchitectureRenderer objects useful for creating module architecture diagrams.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Namespace</span></code>(**kwargs)</p></td>
<td><p>Simple object for storing attributes.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ids_prefix</span></code>(block, io_blocks[, skip_io])</p></td>
<td><p>Adds to block id a prefix consisting of parent id and separator as defined in propagated schema.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_blocks_dict</span></code>(blocks)</p></td>
<td><p>Function that creates a dictionary of blocks using _id as keys.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">namespace_to_dict</span></code>(cfg_ns)</p></td>
<td><p>Converts a nested namespace into a nested dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_graph</span></code>(from_blocks, block)</p></td>
<td><p>Parses a graph of a block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympify_variable</span></code>(value)</p></td>
<td><p>Returns the sympyfied object for the given value.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.render.ModuleArchitectureRenderer">
<em class="property">class </em><code class="sig-prename descclassname">narchi.render.</code><code class="sig-name descname">ModuleArchitectureRenderer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">architecture</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cfg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parser</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/render.html#ModuleArchitectureRenderer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.render.ModuleArchitectureRenderer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.module.ModuleArchitecture" title="narchi.module.ModuleArchitecture"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.module.ModuleArchitecture</span></code></a></p>
<p>Class for instantiating a ModuleArchitectureRenderer objects useful for creating module architecture diagrams.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.render.ModuleArchitectureRenderer.apply_config" title="narchi.render.ModuleArchitectureRenderer.apply_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_config</span></code></a>(cfg)</p></td>
<td><p>Applies a configuration to the ModuleArchitectureRenderer instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.render.ModuleArchitectureRenderer.create_graph" title="narchi.render.ModuleArchitectureRenderer.create_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_graph</span></code></a>()</p></td>
<td><p>Creates a pygraphviz graph of the architecture using the current configuration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.render.ModuleArchitectureRenderer.get_config_parser" title="narchi.render.ModuleArchitectureRenderer.get_config_parser"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config_parser</span></code></a>()</p></td>
<td><p>Returns a ModuleArchitectureRenderer configuration parser.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.render.ModuleArchitectureRenderer.render" title="narchi.render.ModuleArchitectureRenderer.render"><code class="xref py py-obj docutils literal notranslate"><span class="pre">render</span></code></a>([architecture, out_render, cfg])</p></td>
<td><p>Renders the architecture diagram optionally writing to the given file path.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.render.ModuleArchitectureRenderer.get_config_parser">
<em class="property">static </em><code class="sig-name descname">get_config_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/render.html#ModuleArchitectureRenderer.get_config_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.render.ModuleArchitectureRenderer.get_config_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a ModuleArchitectureRenderer configuration parser.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.render.ModuleArchitectureRenderer.apply_config">
<code class="sig-name descname">apply_config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cfg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/render.html#ModuleArchitectureRenderer.apply_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.render.ModuleArchitectureRenderer.apply_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a configuration to the ModuleArchitectureRenderer instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cfg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><em>Namespace</em>) – Path to config file or config object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.render.ModuleArchitectureRenderer.create_graph">
<code class="sig-name descname">create_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/render.html#ModuleArchitectureRenderer.create_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.render.ModuleArchitectureRenderer.create_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pygraphviz graph of the architecture using the current configuration.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.render.ModuleArchitectureRenderer.render">
<code class="sig-name descname">render</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">architecture</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">out_render</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cfg</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/render.html#ModuleArchitectureRenderer.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.render.ModuleArchitectureRenderer.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders the architecture diagram optionally writing to the given file path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>architecture</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>Path</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Path to a jsonnet architecture file.</p></li>
<li><p><strong>out_render</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>Path</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Path where to write the rendered diagram with a valid                                               extension for pygraphviz to determine the type.</p></li>
<li><p><strong>cfg</strong> (<em>Namespace</em>) – Configuration to apply before rendering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pygraphviz graph object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>AGraph</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.schemas">
<span id="narchi-schemas"></span><h2>narchi.schemas<a class="headerlink" href="#module-narchi.schemas" title="Permalink to this headline">¶</a></h2>
<p>Definition of the narchi json schemas.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.schemas.SchemasEnum" title="narchi.schemas.SchemasEnum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SchemasEnum</span></code></a>(value)</p></td>
<td><p>Enum of the schemas defined in narchi.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">jsonvalidator</span></code></p></td>
<td><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">jsonschema.validators.create.&lt;locals&gt;.Validator</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code>(x[, memo, _nil])</p></td>
<td><p>Deep copy operation on arbitrary Python objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.schemas.schema_as_str" title="narchi.schemas.schema_as_str"><code class="xref py py-obj docutils literal notranslate"><span class="pre">schema_as_str</span></code></a>([schema])</p></td>
<td><p>Formats a schema as a pretty printed json string.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.schemas.SchemasEnum">
<em class="property">class </em><code class="sig-prename descclassname">narchi.schemas.</code><code class="sig-name descname">SchemasEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/schemas.html#SchemasEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.schemas.SchemasEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Enum of the schemas defined in narchi.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.schemas.SchemasEnum.narchi" title="narchi.schemas.SchemasEnum.narchi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">narchi</span></code></a></p></td>
<td><p>Main schema which defines the general format for architecture files.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.schemas.SchemasEnum.propagated" title="narchi.schemas.SchemasEnum.propagated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagated</span></code></a></p></td>
<td><p>Schema for architectures in which the dimensions have been propagated.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.schemas.SchemasEnum.reshape" title="narchi.schemas.SchemasEnum.reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reshape</span></code></a></p></td>
<td><p>Schema that defines the format to specify reshaping of tensors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.schemas.SchemasEnum.block" title="narchi.schemas.SchemasEnum.block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">block</span></code></a></p></td>
<td><p>Schema for a single architecture block.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.schemas.SchemasEnum.mappings" title="narchi.schemas.SchemasEnum.mappings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mappings</span></code></a></p></td>
<td><p>Schema for mappings between architectures and block implementations.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.schemas.SchemasEnum.narchi">
<code class="sig-name descname">narchi</code><em class="property"> = {'$id': 'https://schema.omnius.com/json/narchi/1.0/schema.json', '$ref': '#/definitions/architecture', '$schema': 'http://json-schema.org/draft-07/schema#', 'definitions': {'architecture': {'additionalProperties': False, 'properties': {'_description': {'$ref': '#/definitions/description'}, '_id': {'$ref': '#/definitions/id'}, 'blocks': {'$ref': '#/definitions/blocks'}, 'graph': {'$ref': '#/definitions/graph'}, 'inputs': {'$ref': '#/definitions/inputs_outputs'}, 'outputs': {'$ref': '#/definitions/inputs_outputs'}}, 'required': ['_id', 'blocks', 'graph', 'inputs', 'outputs'], 'type': 'object'}, 'block': {'allOf': [{'if': {'properties': {'_class': {'enum': ['Sequential', 'Group']}}}, 'then': {'required': ['blocks']}, 'else': {'not': {'required': ['blocks']}}}, {'if': {'properties': {'_class': {'const': 'Group'}}}, 'then': {'required': ['graph', 'input', 'output']}, 'else': {'not': {'required': ['graph', 'input', 'output']}}}, {'if': {'properties': {'_class': {'const': 'Module'}}}, 'then': {'required': ['_path']}, 'else': {'not': {'required': ['_path', '_ext_vars', 'architecture']}}}, {'if': {'properties': {'_class': {'const': 'Sequential'}}}, 'else': {'properties': {'blocks': {'items': {'required': ['_id']}}}}}, {'if': {'properties': {'_class': {'const': 'Concatenate'}}}, 'then': {'required': ['dim']}}, {'if': {'properties': {'_class': {'const': 'Reshape'}}}, 'then': {'required': ['reshape_spec']}, 'else': {'not': {'required': ['reshape_spec']}}}], 'properties': {'_class': {'$ref': '#/definitions/id'}, '_description': {'$ref': '#/definitions/description'}, '_ext_vars': {'type': 'object'}, '_id': {'$ref': '#/definitions/id'}, '_id_share': {'$ref': '#/definitions/id'}, '_name': {'$ref': '#/definitions/id'}, '_path': {'$ref': '#/definitions/path'}, '_shape': {'$ref': '#/definitions/shape'}, 'architecture': {'$ref': '#/definitions/architecture'}, 'blocks': {'$ref': '#/definitions/blocks'}, 'dim': {'type': 'integer'}, 'graph': {'$ref': '#/definitions/graph'}, 'input': {'$ref': '#/definitions/id'}, 'output': {'$ref': '#/definitions/id'}, 'reshape_spec': {'$ref': '#/definitions/reshape'}}, 'required': ['_class'], 'type': 'object'}, 'blocks': {'items': {'$ref': '#/definitions/block'}, 'minItems': 1, 'type': 'array'}, 'description': {'minLength': 8, 'pattern': '^[^&lt;&gt;]+$', 'type': 'string'}, 'dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}]}, 'minItems': 1, 'type': 'array'}, 'dims_in': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}, {'type': 'null'}]}, 'minItems': 1, 'type': 'array'}, 'graph': {'items': {'pattern': '^[A-Za-z_][0-9A-Za-z_]*( +-&gt; +[A-Za-z_][0-9A-Za-z_]*)+$', 'type': 'string'}, 'minItems': 1, 'type': 'array'}, 'id': {'pattern': '^[A-Za-z_][0-9A-Za-z_]*$', 'type': 'string'}, 'inputs_outputs': {'items': {'additionalProperties': False, 'properties': {'_description': {'$ref': '#/definitions/description'}, '_id': {'$ref': '#/definitions/id'}, '_shape': {'$ref': '#/definitions/dims'}}, 'required': ['_id', '_shape'], 'type': 'object'}, 'minItems': 1, 'type': 'array'}, 'path': {'pattern': '.+\\.jsonnet', 'type': 'string'}, 'reshape': {'oneOf': [{'const': 'flatten'}, {'type': 'array', 'minItems': 1, 'items': {'oneOf': [{'$ref': '#/definitions/reshape_index'}, {'$ref': '#/definitions/reshape_flatten'}, {'$ref': '#/definitions/reshape_unflatten'}]}}]}, 'reshape_dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}]}, 'minItems': 2, 'type': 'array'}, 'reshape_flatten': {'items': {'$ref': '#/definitions/reshape_index'}, 'minItems': 2, 'type': 'array'}, 'reshape_index': {'minimum': 0, 'type': 'integer'}, 'reshape_unflatten': {'additionalProperties': False, 'maxProperties': 1, 'minProperties': 1, 'patternProperties': {'^[0-9]+$': {'$ref': '#/definitions/reshape_dims'}}, 'type': 'object'}, 'shape': {'additionalProperties': False, 'properties': {'in': {'$ref': '#/definitions/dims_in'}, 'out': {'$ref': '#/definitions/dims'}}, 'required': ['in', 'out'], 'type': 'object'}}, 'title': 'Neural Network Module Architecture Schema'}</em><a class="headerlink" href="#narchi.schemas.SchemasEnum.narchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Main schema which defines the general format for architecture files.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.schemas.SchemasEnum.propagated">
<code class="sig-name descname">propagated</code><em class="property"> = {'$ref': '#/definitions/architecture', '$schema': 'http://json-schema.org/draft-07/schema#', 'definitions': {'architecture': {'additionalProperties': False, 'properties': {'_description': {'$ref': '#/definitions/description'}, '_id': {'$ref': '#/definitions/id'}, '_shape': {'$ref': '#/definitions/shape'}, 'blocks': {'$ref': '#/definitions/blocks'}, 'graph': {'$ref': '#/definitions/graph'}, 'inputs': {'$ref': '#/definitions/inputs_outputs'}, 'outputs': {'$ref': '#/definitions/inputs_outputs'}}, 'required': ['_id', 'blocks', 'graph', 'inputs', 'outputs'], 'type': 'object'}, 'block': {'allOf': [{'if': {'properties': {'_class': {'enum': ['Sequential', 'Group']}}}, 'then': {'required': ['blocks']}, 'else': {'not': {'required': ['blocks']}}}, {'if': {'properties': {'_class': {'const': 'Group'}}}, 'then': {'required': ['graph', 'input', 'output']}, 'else': {'not': {'required': ['graph', 'input', 'output']}}}, {'if': {'properties': {'_class': {'const': 'Module'}}}, 'then': {'required': ['_path']}, 'else': {'not': {'required': ['_path', '_ext_vars', 'architecture']}}}, {'if': {'properties': {'_class': {'const': 'Sequential'}}}, 'else': {'properties': {'blocks': {'items': {'required': ['_id']}}}}}, {'if': {'properties': {'_class': {'const': 'Concatenate'}}}, 'then': {'required': ['dim']}}, {'if': {'properties': {'_class': {'const': 'Reshape'}}}, 'then': {'required': ['reshape_spec']}, 'else': {'not': {'required': ['reshape_spec']}}}], 'properties': {'_class': {'$ref': '#/definitions/id'}, '_description': {'$ref': '#/definitions/description'}, '_ext_vars': {'type': 'object'}, '_id': {'$ref': '#/definitions/id'}, '_id_share': {'$ref': '#/definitions/id'}, '_name': {'$ref': '#/definitions/id'}, '_path': {'$ref': '#/definitions/path'}, '_shape': {'$ref': '#/definitions/shape'}, 'architecture': {'$ref': '#/definitions/architecture'}, 'blocks': {'$ref': '#/definitions/blocks'}, 'dim': {'type': 'integer'}, 'graph': {'$ref': '#/definitions/graph'}, 'input': {'$ref': '#/definitions/id'}, 'output': {'$ref': '#/definitions/id'}, 'reshape_spec': {'$ref': '#/definitions/reshape'}}, 'required': ['_class', '_shape'], 'type': 'object'}, 'blocks': {'items': {'$ref': '#/definitions/block'}, 'minItems': 1, 'type': 'array'}, 'description': {'minLength': 8, 'pattern': '^[^&lt;&gt;]+$', 'type': 'string'}, 'dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;$'}]}, 'minItems': 1, 'type': 'array'}, 'dims_in': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}, {'type': 'null'}]}, 'minItems': 1, 'type': 'array'}, 'graph': {'items': {'pattern': '^[A-Za-z_][0-9A-Za-z_·]*( +-&gt; +[A-Za-z_][0-9A-Za-z_·]*)+$', 'type': 'string'}, 'minItems': 1, 'type': 'array'}, 'id': {'pattern': '^[A-Za-z_][0-9A-Za-z_·]*$', 'type': 'string'}, 'inputs_outputs': {'items': {'additionalProperties': False, 'properties': {'_description': {'$ref': '#/definitions/description'}, '_id': {'$ref': '#/definitions/id'}, '_shape': {'$ref': '#/definitions/dims'}}, 'required': ['_id', '_shape'], 'type': 'object'}, 'minItems': 1, 'type': 'array'}, 'path': {'pattern': '.+\\.jsonnet', 'type': 'string'}, 'reshape': {'oneOf': [{'const': 'flatten'}, {'type': 'array', 'minItems': 1, 'items': {'oneOf': [{'$ref': '#/definitions/reshape_index'}, {'$ref': '#/definitions/reshape_flatten'}, {'$ref': '#/definitions/reshape_unflatten'}]}}]}, 'reshape_dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}]}, 'minItems': 2, 'type': 'array'}, 'reshape_flatten': {'items': {'$ref': '#/definitions/reshape_index'}, 'minItems': 2, 'type': 'array'}, 'reshape_index': {'minimum': 0, 'type': 'integer'}, 'reshape_unflatten': {'additionalProperties': False, 'maxProperties': 1, 'minProperties': 1, 'patternProperties': {'^[0-9]+$': {'$ref': '#/definitions/reshape_dims'}}, 'type': 'object'}, 'shape': {'additionalProperties': False, 'properties': {'in': {'$ref': '#/definitions/dims_in'}, 'out': {'$ref': '#/definitions/dims'}}, 'required': ['in', 'out'], 'type': 'object'}}, 'title': 'Neural Network Module Propagated Architecture Schema'}</em><a class="headerlink" href="#narchi.schemas.SchemasEnum.propagated" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for architectures in which the dimensions have been propagated.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.schemas.SchemasEnum.reshape">
<code class="sig-name descname">reshape</code><em class="property"> = {'$ref': '#/definitions/reshape', 'definitions': {'reshape': {'oneOf': [{'const': 'flatten'}, {'type': 'array', 'minItems': 1, 'items': {'oneOf': [{'$ref': '#/definitions/reshape_index'}, {'$ref': '#/definitions/reshape_flatten'}, {'$ref': '#/definitions/reshape_unflatten'}]}}]}, 'reshape_dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}]}, 'minItems': 2, 'type': 'array'}, 'reshape_flatten': {'items': {'$ref': '#/definitions/reshape_index'}, 'minItems': 2, 'type': 'array'}, 'reshape_index': {'minimum': 0, 'type': 'integer'}, 'reshape_unflatten': {'additionalProperties': False, 'maxProperties': 1, 'minProperties': 1, 'patternProperties': {'^[0-9]+$': {'$ref': '#/definitions/reshape_dims'}}, 'type': 'object'}}}</em><a class="headerlink" href="#narchi.schemas.SchemasEnum.reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema that defines the format to specify reshaping of tensors.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.schemas.SchemasEnum.block">
<code class="sig-name descname">block</code><em class="property"> = {'$ref': '#/definitions/block', 'definitions': {'architecture': {'additionalProperties': False, 'properties': {'_description': {'$ref': '#/definitions/description'}, '_id': {'$ref': '#/definitions/id'}, 'blocks': {'$ref': '#/definitions/blocks'}, 'graph': {'$ref': '#/definitions/graph'}, 'inputs': {'$ref': '#/definitions/inputs_outputs'}, 'outputs': {'$ref': '#/definitions/inputs_outputs'}}, 'required': ['_id', 'blocks', 'graph', 'inputs', 'outputs'], 'type': 'object'}, 'block': {'allOf': [{'if': {'properties': {'_class': {'enum': ['Sequential', 'Group']}}}, 'then': {'required': ['blocks']}, 'else': {'not': {'required': ['blocks']}}}, {'if': {'properties': {'_class': {'const': 'Group'}}}, 'then': {'required': ['graph', 'input', 'output']}, 'else': {'not': {'required': ['graph', 'input', 'output']}}}, {'if': {'properties': {'_class': {'const': 'Module'}}}, 'then': {'required': ['_path']}, 'else': {'not': {'required': ['_path', '_ext_vars', 'architecture']}}}, {'if': {'properties': {'_class': {'const': 'Sequential'}}}, 'else': {'properties': {'blocks': {'items': {'required': ['_id']}}}}}, {'if': {'properties': {'_class': {'const': 'Concatenate'}}}, 'then': {'required': ['dim']}}, {'if': {'properties': {'_class': {'const': 'Reshape'}}}, 'then': {'required': ['reshape_spec']}, 'else': {'not': {'required': ['reshape_spec']}}}], 'properties': {'_class': {'$ref': '#/definitions/id'}, '_description': {'$ref': '#/definitions/description'}, '_ext_vars': {'type': 'object'}, '_id': {'$ref': '#/definitions/id'}, '_id_share': {'$ref': '#/definitions/id'}, '_name': {'$ref': '#/definitions/id'}, '_path': {'$ref': '#/definitions/path'}, '_shape': {'$ref': '#/definitions/shape'}, 'architecture': {'$ref': '#/definitions/architecture'}, 'blocks': {'$ref': '#/definitions/blocks'}, 'dim': {'type': 'integer'}, 'graph': {'$ref': '#/definitions/graph'}, 'input': {'$ref': '#/definitions/id'}, 'output': {'$ref': '#/definitions/id'}, 'reshape_spec': {'$ref': '#/definitions/reshape'}}, 'required': ['_class'], 'type': 'object'}, 'blocks': {'items': {'$ref': '#/definitions/block'}, 'minItems': 1, 'type': 'array'}, 'description': {'minLength': 8, 'pattern': '^[^&lt;&gt;]+$', 'type': 'string'}, 'dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}]}, 'minItems': 1, 'type': 'array'}, 'dims_in': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}, {'type': 'null'}]}, 'minItems': 1, 'type': 'array'}, 'graph': {'items': {'pattern': '^[A-Za-z_][0-9A-Za-z_·]*( +-&gt; +[A-Za-z_][0-9A-Za-z_·]*)+$', 'type': 'string'}, 'minItems': 1, 'type': 'array'}, 'id': {'pattern': '^[A-Za-z_][0-9A-Za-z_·]*$', 'type': 'string'}, 'inputs_outputs': {'items': {'additionalProperties': False, 'properties': {'_description': {'$ref': '#/definitions/description'}, '_id': {'$ref': '#/definitions/id'}, '_shape': {'$ref': '#/definitions/dims'}}, 'required': ['_id', '_shape'], 'type': 'object'}, 'minItems': 1, 'type': 'array'}, 'path': {'pattern': '.+\\.jsonnet', 'type': 'string'}, 'reshape': {'oneOf': [{'const': 'flatten'}, {'type': 'array', 'minItems': 1, 'items': {'oneOf': [{'$ref': '#/definitions/reshape_index'}, {'$ref': '#/definitions/reshape_flatten'}, {'$ref': '#/definitions/reshape_unflatten'}]}}]}, 'reshape_dims': {'items': {'oneOf': [{'type': 'integer', 'minimum': 1}, {'type': 'string', 'pattern': '^(&lt;&lt;variable:([-+/*0-9A-Za-z_]+)&gt;&gt;|&lt;&lt;auto&gt;&gt;)$'}]}, 'minItems': 2, 'type': 'array'}, 'reshape_flatten': {'items': {'$ref': '#/definitions/reshape_index'}, 'minItems': 2, 'type': 'array'}, 'reshape_index': {'minimum': 0, 'type': 'integer'}, 'reshape_unflatten': {'additionalProperties': False, 'maxProperties': 1, 'minProperties': 1, 'patternProperties': {'^[0-9]+$': {'$ref': '#/definitions/reshape_dims'}}, 'type': 'object'}, 'shape': {'additionalProperties': False, 'properties': {'in': {'$ref': '#/definitions/dims_in'}, 'out': {'$ref': '#/definitions/dims'}}, 'required': ['in', 'out'], 'type': 'object'}}}</em><a class="headerlink" href="#narchi.schemas.SchemasEnum.block" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for a single architecture block.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.schemas.SchemasEnum.mappings">
<code class="sig-name descname">mappings</code><em class="property"> = {'additionalProperties': False, 'minProperties': 1, 'patternProperties': {'^[A-Za-z_][0-9A-Za-z_]*$': {'properties': {'additionalProperties': False, 'class': {'pattern': '^[A-Za-z_][0-9A-Za-z_.]*$', 'type': 'string'}, 'kwargs': {'additionalProperties': False, 'patternProperties': {'^:skip:$': {'pattern': '^[A-Za-z_][0-9A-Za-z_]*$', 'type': 'string'}, '^[A-Za-z_][0-9A-Za-z_]*$': {'oneOf': [{'pattern': '^[A-Za-z_][0-9A-Za-z_]*$'}, {'pattern': '^shape:in:(|-)[0-9]+$'}, {'pattern': '^const:str:[^:]+$'}, {'pattern': '^const:int:[0-9]+$'}, {'pattern': '^const:bool:(True|False)$'}], 'type': 'string'}}, 'type': 'object'}, 'required': ['class']}, 'type': 'object'}}, 'type': 'object'}</em><a class="headerlink" href="#narchi.schemas.SchemasEnum.mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for mappings between architectures and block implementations.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="narchi.schemas.schema_as_str">
<code class="sig-prename descclassname">narchi.schemas.</code><code class="sig-name descname">schema_as_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">schema</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/schemas.html#schema_as_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.schemas.schema_as_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats a schema as a pretty printed json string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – The schema name to return among {‘narchi’, ‘propagated’, ‘reshape’, ‘block’, ‘mappings’}.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pretty printed schema.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-narchi.sympy">
<span id="narchi-sympy"></span><h2>narchi.sympy<a class="headerlink" href="#module-narchi.sympy" title="Permalink to this headline">¶</a></h2>
<p>Functions for symbolic operations.</p>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.sympy.conv_out_length" title="narchi.sympy.conv_out_length"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conv_out_length</span></code></a>(length, kernel, stride, …)</p></td>
<td><p>Performs a symbolic calculation of the output length of a convolution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.sympy.divide" title="narchi.sympy.divide"><code class="xref py py-obj docutils literal notranslate"><span class="pre">divide</span></code></a>(numerator, denominator)</p></td>
<td><p>Performs a symbolic division.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.sympy.get_nonrational_variable" title="narchi.sympy.get_nonrational_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_nonrational_variable</span></code></a>(value)</p></td>
<td><p>Returns either an int or a string variable.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.sympy.is_valid_dim" title="narchi.sympy.is_valid_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_valid_dim</span></code></a>(value)</p></td>
<td><p>Checks whether value is an int &gt; 0 or str that follows variable_regex.pattern.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.sympy.prod" title="narchi.sympy.prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prod</span></code></a>(values)</p></td>
<td><p>Performs a symbolic product of all input values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.sympy.sum" title="narchi.sympy.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum</span></code></a>(values)</p></td>
<td><p>Performs a symbolic sum of all input values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.sympy.sympify_variable" title="narchi.sympy.sympify_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympify_variable</span></code></a>(value)</p></td>
<td><p>Returns the sympyfied object for the given value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.sympy.variable_operate" title="narchi.sympy.variable_operate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_operate</span></code></a>(value, operation)</p></td>
<td><p>Performs a symbolic operation on a given value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.sympy.variables_aggregate" title="narchi.sympy.variables_aggregate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables_aggregate</span></code></a>(values, operation)</p></td>
<td><p>Performs a symbolic aggregation operation over all input values.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="narchi.sympy.is_valid_dim">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">is_valid_dim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#is_valid_dim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.is_valid_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether value is an int &gt; 0 or str that follows variable_regex.pattern.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.sympify_variable">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">sympify_variable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#sympify_variable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.sympify_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sympyfied object for the given value.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.get_nonrational_variable">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">get_nonrational_variable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#get_nonrational_variable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.get_nonrational_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns either an int or a string variable.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.variable_operate">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">variable_operate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">operation</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#variable_operate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.variable_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a symbolic operation on a given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The value to operate on, either an int or a variable, e.g. “&lt;&lt;variable:W/2+H/4&gt;&gt;”.</p></li>
<li><p><strong>operation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Operation to apply on value, either int or expression, e.g. “__input__/3”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If operation is not int nor a valid expression.
    * If value is not an int or a string that follows variable_regex.pattern.
    * If value is not a valid expression or contains “__input__” as a free symbol.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.variables_aggregate">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">variables_aggregate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em>, <em class="sig-param"><span class="n">operation</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#variables_aggregate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.variables_aggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a symbolic aggregation operation over all input values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em>) – List of values to operate on.</p></li>
<li><p><strong>operation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – One of ‘+’=sum, ‘*’=prod.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any value is not an int or a string that follows variable_regex.pattern.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.sum">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">sum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a symbolic sum of all input values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em>) – List of values to operate on.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any value is not an int or a string that follows variable_regex.pattern.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.prod">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">prod</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#prod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.prod" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a symbolic product of all input values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em>) – List of values to operate on.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any value is not an int or a string that follows variable_regex.pattern.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.divide">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">divide</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">numerator</span></em>, <em class="sig-param"><span class="n">denominator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#divide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.divide" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a symbolic division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numerator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Value for numerator.</p></li>
<li><p><strong>denominator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Value for denominator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any value is not an int or a string that follows variable_regex.pattern.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.sympy.conv_out_length">
<code class="sig-prename descclassname">narchi.sympy.</code><code class="sig-name descname">conv_out_length</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">length</span></em>, <em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">stride</span></em>, <em class="sig-param"><span class="n">padding</span></em>, <em class="sig-param"><span class="n">dilation</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/sympy.html#conv_out_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.sympy.conv_out_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a symbolic calculation of the output length of a convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Length of the input, either an int or a variable.</p></li>
<li><p><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of the kernel in the direction of length.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Stride size in the direction of the length.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Padding added at both sides in the direction of the length.</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dilation size in the direction of the length.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.base">
<span id="narchi-propagators-base"></span><h2>narchi.propagators.base<a class="headerlink" href="#module-narchi.propagators.base" title="Permalink to this headline">¶</a></h2>
<p>Base propagator class and related functions.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code></a>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Namespace</span></code>(**kwargs)</p></td>
<td><p>Simple object for storing attributes.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.check_output_feats_dims" title="narchi.propagators.base.check_output_feats_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_output_feats_dims</span></code></a>(output_feats_dims, …)</p></td>
<td><p>Checks the output_feats attribute of a block.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.base.create_shape" title="narchi.propagators.base.create_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code></a>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code>(x[, memo, _nil])</p></td>
<td><p>Deep copy operation on arbitrary Python objects.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict_to_namespace</span></code>(cfg_dict)</p></td>
<td><p>Converts a nested dictionary into a nested namespace.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.get_shape" title="narchi.propagators.base.get_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code></a>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_valid_dim</span></code>(value)</p></td>
<td><p>Checks whether value is an int &gt; 0 or str that follows variable_regex.pattern.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">namespace_to_dict</span></code>(cfg_ns)</p></td>
<td><p>Converts a nested namespace into a nested dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.base.set_shape_dim" title="narchi.propagators.base.set_shape_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_shape_dim</span></code></a>(key, shape, dim, val)</p></td>
<td><p>Sets a value for a given dimension, shape and key (‘in’ or ‘out’).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.shape_has_auto" title="narchi.propagators.base.shape_has_auto"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape_has_auto</span></code></a>(shape)</p></td>
<td><p>Checks whether a shape has any &lt;&lt;auto&gt;&gt; values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.base.shapes_agree" title="narchi.propagators.base.shapes_agree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shapes_agree</span></code></a>(shape_from, shape_to)</p></td>
<td><p>Checks whether the output shape from a block agrees with input shape of another block.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="narchi.propagators.base.get_shape">
<code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">get_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#get_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.get_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the shape list for a given key among {‘in’,’out’}.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.base.create_shape">
<code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">create_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape_in</span></em>, <em class="sig-param"><span class="n">shape_out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#create_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.create_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.base.set_shape_dim">
<code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">set_shape_dim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">shape</span></em>, <em class="sig-param"><span class="n">dim</span></em>, <em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#set_shape_dim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.set_shape_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a value for a given dimension, shape and key (‘in’ or ‘out’).</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.base.shapes_agree">
<code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">shapes_agree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape_from</span></em>, <em class="sig-param"><span class="n">shape_to</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#shapes_agree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.shapes_agree" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the output shape from a block agrees with input shape of another block.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.base.shape_has_auto">
<code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">shape_has_auto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#shape_has_auto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.shape_has_auto" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a shape has any &lt;&lt;auto&gt;&gt; values.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.base.check_output_feats_dims">
<code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">check_output_feats_dims</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_feats_dims</span></em>, <em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#check_output_feats_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.check_output_feats_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the output_feats attribute of a block.</p>
</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.base.BasePropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.base.</code><code class="sig-name descname">BasePropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#BasePropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.BasePropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for block shapes propagation.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.__call__" title="narchi.propagators.base.BasePropagator.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(from_blocks, block[, propagators, …])</p></td>
<td><p>Propagates shapes to the given block.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.__init__" title="narchi.propagators.base.BasePropagator.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(block_class)</p></td>
<td><p>Initializer for BasePropagator instance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.final_checks" title="narchi.propagators.base.BasePropagator.final_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">final_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that checks for problems after shapes have been propagated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.initial_checks" title="narchi.propagators.base.BasePropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.propagate" title="narchi.propagators.base.BasePropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.block_class" title="narchi.propagators.base.BasePropagator.block_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">block_class</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.num_input_blocks" title="narchi.propagators.base.BasePropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.base.BasePropagator.output_feats_dims" title="narchi.propagators.base.BasePropagator.output_feats_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_feats_dims</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.base.BasePropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = None</em><a class="headerlink" href="#narchi.propagators.base.BasePropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.base.BasePropagator.output_feats_dims">
<code class="sig-name descname">output_feats_dims</code><em class="property"> = False</em><a class="headerlink" href="#narchi.propagators.base.BasePropagator.output_feats_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.base.BasePropagator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#BasePropagator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.BasePropagator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for BasePropagator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the block class being propagated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.base.BasePropagator.block_class">
<code class="sig-name descname">block_class</code><em class="property"> = None</em><a class="headerlink" href="#narchi.propagators.base.BasePropagator.block_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.base.BasePropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#BasePropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.BasePropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Extensions of this method in derived classes should always call this
base method. This base method implements the following checks:</p>
<ul class="simple">
<li><p>That the block class is the same as the one expected by the
propagator.</p></li>
<li><p>That the input shapes don’t contain any &lt;&lt;auto&gt;&gt; values.</p></li>
<li><p>If num_input_blocks is set and is an int, that there are exactly this
number of input blocks.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If block fails to validate against schema.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If block already has a _shape attribute.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If block._class != block_class.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If input shape not present, invalid or contains &lt;&lt;auto&gt;&gt;.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If output_feats required by class and not present or invalid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If len(from_blocks) != num_input_blocks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.base.BasePropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#BasePropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.BasePropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<p>This base method should be implemented by all derived classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – Always.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.base.BasePropagator.final_checks">
<code class="sig-name descname">final_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#BasePropagator.final_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.BasePropagator.final_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that checks for problems after shapes have been propagated.</p>
<p>This base method implements checking the output shape don’t contain
&lt;&lt;auto&gt;&gt; values and if there is only a single from_block, that the
connecting shapes agree. Extensions of this method in derived classes
should always call this base one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.base.BasePropagator.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_vars</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/base.html#BasePropagator.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.base.BasePropagator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates shapes to the given block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
<li><p><strong>propagators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of propagators.</p></li>
<li><p><strong>ext_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of external variables required to load jsonnet.</p></li>
<li><p><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Working directory to resolve relative paths.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.concat">
<span id="narchi-propagators-concat"></span><h2>narchi.propagators.concat<a class="headerlink" href="#module-narchi.propagators.concat" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes for concatenating.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.concat.ConcatenatePropagator" title="narchi.propagators.concat.ConcatenatePropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConcatenatePropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for concatenating along a given dimension.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum</span></code>(values)</p></td>
<td><p>Performs a symbolic sum of all input values.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.propagators.concat.ConcatenatePropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.concat.</code><code class="sig-name descname">ConcatenatePropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/concat.html#ConcatenatePropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.concat.ConcatenatePropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for concatenating along a given dimension.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.concat.ConcatenatePropagator.initial_checks" title="narchi.propagators.concat.ConcatenatePropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.concat.ConcatenatePropagator.propagate" title="narchi.propagators.concat.ConcatenatePropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.concat.ConcatenatePropagator.num_input_blocks" title="narchi.propagators.concat.ConcatenatePropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.concat.ConcatenatePropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = '&gt;1'</em><a class="headerlink" href="#narchi.propagators.concat.ConcatenatePropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.concat.ConcatenatePropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/concat.html#ConcatenatePropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.concat.ConcatenatePropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and makes sure that the dim attribute
is valid and agrees with the input dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When block does not have a valid dim attribute that agrees with input dimensions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.concat.ConcatenatePropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/concat.html#ConcatenatePropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.concat.ConcatenatePropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.conv">
<span id="narchi-propagators-conv"></span><h2>narchi.propagators.conv<a class="headerlink" href="#module-narchi.propagators.conv" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes for convolution blocks.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator" title="narchi.propagators.conv.ConvPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConvPropagator</span></code></a>(block_class, conv_dims)</p></td>
<td><p>Propagator for convolution style blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.conv.PoolPropagator" title="narchi.propagators.conv.PoolPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PoolPropagator</span></code></a>(block_class, conv_dims)</p></td>
<td><p>Propagator for pooling style blocks.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_output_feats_dims</span></code>(output_feats_dims, …)</p></td>
<td><p>Checks the output_feats attribute of a block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">conv_out_length</span></code>(length, kernel, stride, …)</p></td>
<td><p>Performs a symbolic calculation of the output length of a convolution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_shape_dim</span></code>(key, shape, dim, val)</p></td>
<td><p>Sets a value for a given dimension, shape and key (‘in’ or ‘out’).</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.propagators.conv.ConvPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.conv.</code><code class="sig-name descname">ConvPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">conv_dims</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/conv.html#ConvPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for convolution style blocks.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator.__init__" title="narchi.propagators.conv.ConvPropagator.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(block_class, conv_dims)</p></td>
<td><p>Initializer for ConvPropagator instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator.initial_checks" title="narchi.propagators.conv.ConvPropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator.propagate" title="narchi.propagators.conv.ConvPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator.conv_dims" title="narchi.propagators.conv.ConvPropagator.conv_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conv_dims</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator.num_features_source" title="narchi.propagators.conv.ConvPropagator.num_features_source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_features_source</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.conv.ConvPropagator.num_input_blocks" title="narchi.propagators.conv.ConvPropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.conv.ConvPropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.conv.ConvPropagator.num_features_source">
<code class="sig-name descname">num_features_source</code><em class="property"> = 'output_feats'</em><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator.num_features_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.conv.ConvPropagator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">conv_dims</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/conv.html#ConvPropagator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for ConvPropagator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the block class being propagated.</p></li>
<li><p><strong>conv_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of dimensions for the convolution.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If conv_dims not int &gt; 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.conv.ConvPropagator.conv_dims">
<code class="sig-name descname">conv_dims</code><em class="property"> = None</em><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator.conv_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.conv.ConvPropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/conv.html#ConvPropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and makes sure that the input shape agrees
with the convolution dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When conv_dims does not agree with from_block[0]._shape.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.conv.ConvPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/conv.html#ConvPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.conv.ConvPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When block.output_feats not valid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If num_features_source is not one of {“from_shape”, “output_feats”}.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.conv.PoolPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.conv.</code><code class="sig-name descname">PoolPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">conv_dims</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/conv.html#PoolPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.conv.PoolPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.conv.ConvPropagator" title="narchi.propagators.conv.ConvPropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.conv.ConvPropagator</span></code></a></p>
<p>Propagator for pooling style blocks.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.conv.PoolPropagator.num_features_source" title="narchi.propagators.conv.PoolPropagator.num_features_source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_features_source</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.conv.PoolPropagator.num_features_source">
<code class="sig-name descname">num_features_source</code><em class="property"> = 'from_shape'</em><a class="headerlink" href="#narchi.propagators.conv.PoolPropagator.num_features_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.fixed">
<span id="narchi-propagators-fixed"></span><h2>narchi.propagators.fixed<a class="headerlink" href="#module-narchi.propagators.fixed" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes for fixed output blocks.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.AddFixedPropagator" title="narchi.propagators.fixed.AddFixedPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AddFixedPropagator</span></code></a>(block_class[, fixed_dims])</p></td>
<td><p>Propagator for blocks that adds fixed dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator" title="narchi.propagators.fixed.FixedOutputPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedOutputPropagator</span></code></a>(block_class[, …])</p></td>
<td><p>Propagator for fixed output size blocks.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.propagators.fixed.AddFixedPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.fixed.</code><code class="sig-name descname">AddFixedPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">fixed_dims</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#AddFixedPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.AddFixedPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for blocks that adds fixed dimensions.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.AddFixedPropagator.__init__" title="narchi.propagators.fixed.AddFixedPropagator.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(block_class[, fixed_dims])</p></td>
<td><p>Initializer for AddFixedPropagator instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.fixed.AddFixedPropagator.propagate" title="narchi.propagators.fixed.AddFixedPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.AddFixedPropagator.fixed_dims" title="narchi.propagators.fixed.AddFixedPropagator.fixed_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fixed_dims</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.propagators.fixed.AddFixedPropagator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">fixed_dims</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#AddFixedPropagator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.AddFixedPropagator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for AddFixedPropagator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the block class being propagated.</p></li>
<li><p><strong>fixed_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of fixed dimensions.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If fixed_dims not int &gt; 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.fixed.AddFixedPropagator.fixed_dims">
<code class="sig-name descname">fixed_dims</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.fixed.AddFixedPropagator.fixed_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.fixed.AddFixedPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#AddFixedPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.AddFixedPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.fixed.FixedOutputPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.fixed.</code><code class="sig-name descname">FixedOutputPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">unfixed_dims</span><span class="o">=</span><span class="default_value">'any'</span></em>, <em class="sig-param"><span class="n">fixed_dims</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#FixedOutputPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for fixed output size blocks.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator.__init__" title="narchi.propagators.fixed.FixedOutputPropagator.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(block_class[, unfixed_dims, fixed_dims])</p></td>
<td><p>Initializer for FixedOutputPropagator instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator.initial_checks" title="narchi.propagators.fixed.FixedOutputPropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator.propagate" title="narchi.propagators.fixed.FixedOutputPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator.num_input_blocks" title="narchi.propagators.fixed.FixedOutputPropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator.output_feats_dims" title="narchi.propagators.fixed.FixedOutputPropagator.output_feats_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_feats_dims</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.fixed.FixedOutputPropagator.unfixed_dims" title="narchi.propagators.fixed.FixedOutputPropagator.unfixed_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfixed_dims</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.fixed.FixedOutputPropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.fixed.FixedOutputPropagator.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em>, <em class="sig-param"><span class="n">unfixed_dims</span><span class="o">=</span><span class="default_value">'any'</span></em>, <em class="sig-param"><span class="n">fixed_dims</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#FixedOutputPropagator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for FixedOutputPropagator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the block class being propagated.</p></li>
<li><p><strong>fixed_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of fixed dimensions.</p></li>
<li><p><strong>unfixed_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Number of unfixed dimensions.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If fixed_dims not int &gt; 0.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If unfixed_dims not “any” or int &gt; 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.fixed.FixedOutputPropagator.unfixed_dims">
<code class="sig-name descname">unfixed_dims</code><em class="property"> = 'any'</em><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator.unfixed_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.fixed.FixedOutputPropagator.output_feats_dims">
<code class="sig-name descname">output_feats_dims</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator.output_feats_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.fixed.FixedOutputPropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#FixedOutputPropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and makes sure that the input shape has at
least (fixed_dims+1) dimensions if unfixed_dims==”any” or exactly
(fixed_dims+fixed_dims) dimensions if unfixed_dims is int.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When fixed_dims and unfixed_dims do not agree with from_block[0]._shape.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.fixed.FixedOutputPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/fixed.html#FixedOutputPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.fixed.FixedOutputPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.group">
<span id="narchi-propagators-group"></span><h2>narchi.propagators.group<a class="headerlink" href="#module-narchi.propagators.group" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes for groups of blocks.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.group.GroupPropagator" title="narchi.propagators.group.GroupPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GroupPropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for a sequence of blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">OrderedDict</span></code></p></td>
<td><p>Dictionary that remembers insertion order</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.group.SequentialPropagator" title="narchi.propagators.group.SequentialPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SequentialPropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for a sequence of blocks.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.group.add_ids_prefix" title="narchi.propagators.group.add_ids_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_ids_prefix</span></code></a>(block, io_blocks[, skip_io])</p></td>
<td><p>Adds to block id a prefix consisting of parent id and separator as defined in propagated schema.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.group.get_blocks_dict" title="narchi.propagators.group.get_blocks_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_blocks_dict</span></code></a>(blocks)</p></td>
<td><p>Function that creates a dictionary of blocks using _id as keys.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_graph</span></code>(from_blocks, block)</p></td>
<td><p>Parses a graph of a block.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.group.propagate_shapes" title="narchi.propagators.group.propagate_shapes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate_shapes</span></code></a>(blocks_dict, …[, skip_ids])</p></td>
<td><p>Function that propagates shapes in blocks based on a connections mapping.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="narchi.propagators.group.get_blocks_dict">
<code class="sig-prename descclassname">narchi.propagators.group.</code><code class="sig-name descname">get_blocks_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocks</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#get_blocks_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.get_blocks_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that creates a dictionary of blocks using _id as keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>]</em>) – List of blocks objects.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of blocks.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.group.add_ids_prefix">
<code class="sig-prename descclassname">narchi.propagators.group.</code><code class="sig-name descname">add_ids_prefix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">io_blocks</span></em>, <em class="sig-param"><span class="n">skip_io</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#add_ids_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.add_ids_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds to block id a prefix consisting of parent id and separator as defined in propagated schema.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.group.propagate_shapes">
<code class="sig-prename descclassname">narchi.propagators.group.</code><code class="sig-name descname">propagate_shapes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocks_dict</span></em>, <em class="sig-param"><span class="n">topological_predecessors</span></em>, <em class="sig-param"><span class="n">propagators</span></em>, <em class="sig-param"><span class="n">ext_vars</span></em>, <em class="sig-param"><span class="n">cwd</span></em>, <em class="sig-param"><span class="n">skip_ids</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#propagate_shapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.propagate_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that propagates shapes in blocks based on a connections mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>]</em>) – Dictionary of blocks.</p></li>
<li><p><strong>topological_predecessors</strong> (<em>OrderedDict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – Mapping of block IDs to its input blocks IDs.</p></li>
<li><p><strong>propagators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of propagators.</p></li>
<li><p><strong>skip_ids</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.9)"><em>set</em></a>) – Blocks that should be skipped in propagation.</p></li>
<li><p><strong>ext_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of external variables required to load jsonnet.</p></li>
<li><p><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Working directory to resolve relative paths.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If there graph references an undefined block.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If no propagator found for some block.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.group.SequentialPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.group.</code><code class="sig-name descname">SequentialPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#SequentialPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.SequentialPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for a sequence of blocks.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.group.SequentialPropagator.num_input_blocks" title="narchi.propagators.group.SequentialPropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.group.SequentialPropagator.propagate" title="narchi.propagators.group.SequentialPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block, propagators, …)</p></td>
<td><p>Method that propagates shapes in the given block.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.group.SequentialPropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.group.SequentialPropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.group.SequentialPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span></em>, <em class="sig-param"><span class="n">ext_vars</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#SequentialPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.SequentialPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes in the given block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
<li><p><strong>propagators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of propagators.</p></li>
<li><p><strong>ext_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of external variables required to load jsonnet.</p></li>
<li><p><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Working directory to resolve relative paths.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If there are multiple blocks with the same id.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If no propagator found for some block.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.group.GroupPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.group.</code><code class="sig-name descname">GroupPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#GroupPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.GroupPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.group.SequentialPropagator" title="narchi.propagators.group.SequentialPropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.group.SequentialPropagator</span></code></a></p>
<p>Propagator for a sequence of blocks.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.group.GroupPropagator.propagate" title="narchi.propagators.group.GroupPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block, propagators, …)</p></td>
<td><p>Method that propagates shapes in the given block.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.propagators.group.GroupPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">propagators</span></em>, <em class="sig-param"><span class="n">ext_vars</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/group.html#GroupPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.group.GroupPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes in the given block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
<li><p><strong>propagators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of propagators.</p></li>
<li><p><strong>ext_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of external variables required to load jsonnet.</p></li>
<li><p><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Working directory to resolve relative paths.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If there are multiple blocks with the same id.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If there graph references an undefined block.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If no propagator found for some block.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.reshape">
<span id="narchi-propagators-reshape"></span><h2>narchi.propagators.reshape<a class="headerlink" href="#module-narchi.propagators.reshape" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes for reshaping.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Namespace</span></code>(**kwargs)</p></td>
<td><p>Simple object for storing attributes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.reshape.ReshapePropagator" title="narchi.propagators.reshape.ReshapePropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReshapePropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for reshapping which could involve any of: permute, flatten and unflatten.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.reshape.check_reshape_spec" title="narchi.propagators.reshape.check_reshape_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_reshape_spec</span></code></a>(reshape_spec)</p></td>
<td><p>Checks that reshape_spec is valid according to schema, indexes range is valid and there is at most one &lt;&lt;auto&gt;&gt; in each unflatten.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">divide</span></code>(numerator, denominator)</p></td>
<td><p>Performs a symbolic division.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">n2d</span></code>(cfg_ns)</p></td>
<td><p>Converts a nested namespace into a nested dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.reshape.norm_reshape_spec" title="narchi.propagators.reshape.norm_reshape_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm_reshape_spec</span></code></a>(reshape_spec)</p></td>
<td><p>Converts elements of a reshape_spec from Namespace to dict.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">prod</span></code>(values)</p></td>
<td><p>Performs a symbolic product of all input values.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="narchi.propagators.reshape.check_reshape_spec">
<code class="sig-prename descclassname">narchi.propagators.reshape.</code><code class="sig-name descname">check_reshape_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reshape_spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/reshape.html#check_reshape_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.reshape.check_reshape_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that reshape_spec is valid according to schema, indexes range is valid and there is at most one &lt;&lt;auto&gt;&gt; in each unflatten.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.propagators.reshape.norm_reshape_spec">
<code class="sig-prename descclassname">narchi.propagators.reshape.</code><code class="sig-name descname">norm_reshape_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reshape_spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/reshape.html#norm_reshape_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.reshape.norm_reshape_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts elements of a reshape_spec from Namespace to dict.</p>
</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.reshape.ReshapePropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.reshape.</code><code class="sig-name descname">ReshapePropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/reshape.html#ReshapePropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.reshape.ReshapePropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for reshapping which could involve any of: permute, flatten and unflatten.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.reshape.ReshapePropagator.initial_checks" title="narchi.propagators.reshape.ReshapePropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.reshape.ReshapePropagator.propagate" title="narchi.propagators.reshape.ReshapePropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.reshape.ReshapePropagator.num_input_blocks" title="narchi.propagators.reshape.ReshapePropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.reshape.ReshapePropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.reshape.ReshapePropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.reshape.ReshapePropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/reshape.html#ReshapePropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.reshape.ReshapePropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and makes sure that the reshape_spec
attribute is valid and agrees with the input dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When block does not have a valid reshape_spec attribute that agrees with input dimensions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.reshape.ReshapePropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/reshape.html#ReshapePropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.reshape.ReshapePropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.rnn">
<span id="narchi-propagators-rnn"></span><h2>narchi.propagators.rnn<a class="headerlink" href="#module-narchi.propagators.rnn" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes for recurrent blocks.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.rnn.RnnPropagator" title="narchi.propagators.rnn.RnnPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RnnPropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for recurrent style blocks.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_shape_dim</span></code>(key, shape, dim, val)</p></td>
<td><p>Sets a value for a given dimension, shape and key (‘in’ or ‘out’).</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.propagators.rnn.RnnPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.rnn.</code><code class="sig-name descname">RnnPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/rnn.html#RnnPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.rnn.RnnPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for recurrent style blocks.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.rnn.RnnPropagator.initial_checks" title="narchi.propagators.rnn.RnnPropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.rnn.RnnPropagator.propagate" title="narchi.propagators.rnn.RnnPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.rnn.RnnPropagator.num_input_blocks" title="narchi.propagators.rnn.RnnPropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.rnn.RnnPropagator.output_feats_dims" title="narchi.propagators.rnn.RnnPropagator.output_feats_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_feats_dims</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.rnn.RnnPropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.rnn.RnnPropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.propagators.rnn.RnnPropagator.output_feats_dims">
<code class="sig-name descname">output_feats_dims</code><em class="property"> = 1</em><a class="headerlink" href="#narchi.propagators.rnn.RnnPropagator.output_feats_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.propagators.rnn.RnnPropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/rnn.html#RnnPropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.rnn.RnnPropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and makes sure that the input shape has two
dimensions and that block includes a valid output_feats attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When block.output_feats not valid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When len(from_block[0]._shape) != 2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.rnn.RnnPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/rnn.html#RnnPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.rnn.RnnPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When bidirectional==True and output_feats not even.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.propagators.same">
<span id="narchi-propagators-same"></span><h2>narchi.propagators.same<a class="headerlink" href="#module-narchi.propagators.same" title="Permalink to this headline">¶</a></h2>
<p>Propagator classes that preserve the same shape.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePropagator</span></code>(block_class)</p></td>
<td><p>Base class for block shapes propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapeConsumeDimPropagator" title="narchi.propagators.same.SameShapeConsumeDimPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapeConsumeDimPropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for blocks in which the output shape is the same as input except the last which is consumed.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapePropagator" title="narchi.propagators.same.SameShapePropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapePropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for blocks in which the input and output shapes are the same.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapesPropagator" title="narchi.propagators.same.SameShapesPropagator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SameShapesPropagator</span></code></a>(block_class)</p></td>
<td><p>Propagator for blocks that receive multiple inputs of the same shape and preserves this shape.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_shape</span></code>(shape_in[, shape_out])</p></td>
<td><p>Creates a shape namespace with ‘in’ and ‘out’ attributes and copied shape arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.propagators.same.SameShapePropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.same.</code><code class="sig-name descname">SameShapePropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapePropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapePropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.base.BasePropagator" title="narchi.propagators.base.BasePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.base.BasePropagator</span></code></a></p>
<p>Propagator for blocks in which the input and output shapes are the same.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapePropagator.initial_checks" title="narchi.propagators.same.SameShapePropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapePropagator.propagate" title="narchi.propagators.same.SameShapePropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.propagators.same.SameShapePropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapePropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapePropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and if multi-input makes sure that all
inputs have the same shape and if not multi-input makes sure that there
is only a single input block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When multi_input==False and len(from_blocks) != 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.same.SameShapePropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapePropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapePropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.same.SameShapesPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.same.</code><code class="sig-name descname">SameShapesPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapesPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapesPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.same.SameShapePropagator" title="narchi.propagators.same.SameShapePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.same.SameShapePropagator</span></code></a></p>
<p>Propagator for blocks that receive multiple inputs of the same shape and preserves this shape.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapesPropagator.num_input_blocks" title="narchi.propagators.same.SameShapesPropagator.num_input_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_input_blocks</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.propagators.same.SameShapesPropagator.num_input_blocks">
<code class="sig-name descname">num_input_blocks</code><em class="property"> = '&gt;1'</em><a class="headerlink" href="#narchi.propagators.same.SameShapesPropagator.num_input_blocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.propagators.same.SameShapeConsumeDimPropagator">
<em class="property">class </em><code class="sig-prename descclassname">narchi.propagators.same.</code><code class="sig-name descname">SameShapeConsumeDimPropagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapeConsumeDimPropagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapeConsumeDimPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.propagators.same.SameShapePropagator" title="narchi.propagators.same.SameShapePropagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.propagators.same.SameShapePropagator</span></code></a></p>
<p>Propagator for blocks in which the output shape is the same as input except the last which is consumed.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapeConsumeDimPropagator.initial_checks" title="narchi.propagators.same.SameShapeConsumeDimPropagator.initial_checks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_checks</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that does some initial checks before propagation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.propagators.same.SameShapeConsumeDimPropagator.propagate" title="narchi.propagators.same.SameShapeConsumeDimPropagator.propagate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate</span></code></a>(from_blocks, block)</p></td>
<td><p>Method that propagates shapes to a block.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.propagators.same.SameShapeConsumeDimPropagator.initial_checks">
<code class="sig-name descname">initial_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapeConsumeDimPropagator.initial_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapeConsumeDimPropagator.initial_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that does some initial checks before propagation.</p>
<p>Calls the base class checks and makes sure that the input has more than
one dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – When len(input_shape) &lt; 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.propagators.same.SameShapeConsumeDimPropagator.propagate">
<code class="sig-name descname">propagate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_blocks</span></em>, <em class="sig-param"><span class="n">block</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/propagators/same.html#SameShapeConsumeDimPropagator.propagate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.propagators.same.SameShapeConsumeDimPropagator.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that propagates shapes to a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><em>Namespace</em><em>]</em>) – The input blocks.</p></li>
<li><p><strong>block</strong> (<em>Namespace</em>) – The block to propagate its shapes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.instantiators.common">
<span id="narchi-instantiators-common"></span><h2>narchi.instantiators.common<a class="headerlink" href="#module-narchi.instantiators.common" title="Permalink to this headline">¶</a></h2>
<p>Generic code for module architecture instantiators.</p>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_shape</span></code>(key, shape)</p></td>
<td><p>Gets the shape list for a given key among {‘in’,’out’}.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.common.id_strip_parent_prefix" title="narchi.instantiators.common.id_strip_parent_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id_strip_parent_prefix</span></code></a>(value)</p></td>
<td><p>Removes the parent prefix from an id value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.common.import_object" title="narchi.instantiators.common.import_object"><code class="xref py py-obj docutils literal notranslate"><span class="pre">import_object</span></code></a>(name)</p></td>
<td><p>Function that returns a class in a module given its dot import statement.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.common.instantiate_block" title="narchi.instantiators.common.instantiate_block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">instantiate_block</span></code></a>(block_cfg, …)</p></td>
<td><p>Function that instantiates a block given its narchi config and a mappings object.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="narchi.instantiators.common.id_strip_parent_prefix">
<code class="sig-prename descclassname">narchi.instantiators.common.</code><code class="sig-name descname">id_strip_parent_prefix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/common.html#id_strip_parent_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.common.id_strip_parent_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the parent prefix from an id value.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.instantiators.common.import_object">
<code class="sig-prename descclassname">narchi.instantiators.common.</code><code class="sig-name descname">import_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/common.html#import_object"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.common.import_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns a class in a module given its dot import statement.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.instantiators.common.instantiate_block">
<code class="sig-prename descclassname">narchi.instantiators.common.</code><code class="sig-name descname">instantiate_block</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_cfg</span></em>, <em class="sig-param"><span class="n">blocks_mappings</span></em>, <em class="sig-param"><span class="n">module_cfg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/common.html#instantiate_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.common.instantiate_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that instantiates a block given its narchi config and a mappings object.</p>
</dd></dl>

</div>
<div class="section" id="module-narchi.instantiators.pytorch">
<span id="narchi-instantiators-pytorch"></span><h2>narchi.instantiators.pytorch<a class="headerlink" href="#module-narchi.instantiators.pytorch" title="Permalink to this headline">¶</a></h2>
<p>A standard module instantiator for pytorch.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Add" title="narchi.instantiators.pytorch.Add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Add</span></code></a>()</p></td>
<td><p>Module that adds all inputs element-wise, thus expects all inputs to be the same shape.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule" title="narchi.instantiators.pytorch.BaseModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseModule</span></code></a>(*args[, state_dict, debug])</p></td>
<td><p>Base class for instantiation of pytorch modules based on a narchi architecture.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Concatenate" title="narchi.instantiators.pytorch.Concatenate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Concatenate</span></code></a>(dim)</p></td>
<td><p>Module that concatenates input tensors along a given dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Group" title="narchi.instantiators.pytorch.Group"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Group</span></code></a>(block_id, blocks, blocks_mappings, …)</p></td>
<td><p>Group module that receives narchi blocks, graph, input and output objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.LSTM" title="narchi.instantiators.pytorch.LSTM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LSTM</span></code></a>(*args[, output_state])</p></td>
<td><p>Extension of torch.nn.LSTM that allows disabling the return of the hidden and cell states.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModuleArchitecture</span></code>([architecture, cfg, parser])</p></td>
<td><p>Class for instantiating ModuleArchitecture objects.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">OrderedDict</span></code></p></td>
<td><p>Dictionary that remembers insertion order</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Path</span></code>(path, Path], mode, cwd, skip_check)</p></td>
<td><p>Stores a (possibly relative) path and the corresponding absolute path.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Reshape" title="narchi.instantiators.pytorch.Reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Reshape</span></code></a>(reshape_spec)</p></td>
<td><p>Reshape module configurable by a narchi reshape_spec object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Sequential" title="narchi.instantiators.pytorch.Sequential"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sequential</span></code></a>(blocks, blocks_mappings, module_cfg)</p></td>
<td><p>Sequential module that receives as input an narchi blocks object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.StandardModule" title="narchi.instantiators.pytorch.StandardModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StandardModule</span></code></a>(*args[, state_dict, debug])</p></td>
<td><p>Class for instantiating pytorch modules with standard block mappings.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_reshape_spec</span></code>(reshape_spec)</p></td>
<td><p>Checks that reshape_spec is valid according to schema, indexes range is valid and there is at most one &lt;&lt;auto&gt;&gt; in each unflatten.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_blocks_dict</span></code>(blocks)</p></td>
<td><p>Function that creates a dictionary of blocks using _id as keys.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config_read_mode</span></code>()</p></td>
<td><p>Returns the current config reading mode.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.graph_forward" title="narchi.instantiators.pytorch.graph_forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">graph_forward</span></code></a>(module, values[, out_ids, …])</p></td>
<td><p>Runs a forward for a module using its graph topological_predecessors.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">id_strip_parent_prefix</span></code>(value)</p></td>
<td><p>Removes the parent prefix from an id value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">instantiate_block</span></code>(block_cfg, …)</p></td>
<td><p>Function that instantiates a block given its narchi config and a mappings object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm_reshape_spec</span></code>(reshape_spec)</p></td>
<td><p>Converts elements of a reshape_spec from Namespace to dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_graph</span></code>(from_blocks, block)</p></td>
<td><p>Parses a graph of a block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduce</span></code>(function, sequence[, initial])</p></td>
<td><p>Apply a function of two arguments cumulatively to the items of a sequence, from left to right, so as to reduce the sequence to a single value.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.instantiators.pytorch.BaseModule">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">BaseModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">state_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#BaseModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.BaseModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code>, <a class="reference internal" href="#narchi.module.ModuleArchitecture" title="narchi.module.ModuleArchitecture"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.module.ModuleArchitecture</span></code></a></p>
<p>Base class for instantiation of pytorch modules based on a narchi architecture.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule.__init__" title="narchi.instantiators.pytorch.BaseModule.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(*args[, state_dict, debug])</p></td>
<td><p>Initializer for BaseModule class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule.forward" title="narchi.instantiators.pytorch.BaseModule.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(*args, **kwargs)</p></td>
<td><p>Runs a forward using the architecture’s inputs and graph.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule.inputs_preprocess" title="narchi.instantiators.pytorch.BaseModule.inputs_preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inputs_preprocess</span></code></a>(values)</p></td>
<td><p>Pre-processing for inputs, base implementation does nothing.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule.state_dict_prop" title="narchi.instantiators.pytorch.BaseModule.state_dict_prop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict_prop</span></code></a></p></td>
<td><p>The current state dictionary.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.BaseModule.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">state_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#BaseModule.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.BaseModule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for BaseModule class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – State dictionary to set.</p></li>
<li><p><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Enable to keep self.intermediate_outputs.</p></li>
<li><p><strong>args/kwargs</strong> – All other arguments accepted by <a class="reference internal" href="#narchi.module.ModuleArchitecture" title="narchi.module.ModuleArchitecture"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleArchitecture</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.BaseModule.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#BaseModule.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.BaseModule.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a forward using the architecture’s inputs and graph.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.BaseModule.inputs_preprocess">
<code class="sig-name descname">inputs_preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#BaseModule.inputs_preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.BaseModule.inputs_preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-processing for inputs, base implementation does nothing.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.BaseModule.state_dict_prop">
<em class="property">property </em><code class="sig-name descname">state_dict_prop</code><a class="headerlink" href="#narchi.instantiators.pytorch.BaseModule.state_dict_prop" title="Permalink to this definition">¶</a></dt>
<dd><p>The current state dictionary.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.BaseModule.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.BaseModule.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.Sequential">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">Sequential</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocks</span></em>, <em class="sig-param"><span class="n">blocks_mappings</span></em>, <em class="sig-param"><span class="n">module_cfg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Sequential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Sequential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.container.Sequential</span></code></p>
<p>Sequential module that receives as input an narchi blocks object.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Sequential.__init__" title="narchi.instantiators.pytorch.Sequential.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(blocks, blocks_mappings, module_cfg)</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.Sequential.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">blocks</span></em>, <em class="sig-param"><span class="n">blocks_mappings</span></em>, <em class="sig-param"><span class="n">module_cfg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Sequential.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Sequential.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.Sequential.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.Sequential.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.Add">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">Add</code><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Add" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Module that adds all inputs element-wise, thus expects all inputs to be the same shape.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Add.forward" title="narchi.instantiators.pytorch.Add.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(*inputs)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.Add.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">inputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Add.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Add.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.Add.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.Add.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.Concatenate">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">Concatenate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dim</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Concatenate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Module that concatenates input tensors along a given dimension.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Concatenate.__init__" title="narchi.instantiators.pytorch.Concatenate.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(dim)</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Concatenate.forward" title="narchi.instantiators.pytorch.Concatenate.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(*inputs)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.Concatenate.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dim</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Concatenate.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Concatenate.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.Concatenate.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">inputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Concatenate.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Concatenate.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.Concatenate.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.Concatenate.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.LSTM">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">LSTM</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">output_state</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#LSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.rnn.LSTM</span></code></p>
<p>Extension of torch.nn.LSTM that allows disabling the return of the hidden and cell states.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.LSTM.__init__" title="narchi.instantiators.pytorch.LSTM.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(*args[, output_state])</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.LSTM.forward" title="narchi.instantiators.pytorch.LSTM.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.LSTM.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">output_state</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#LSTM.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.LSTM.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#LSTM.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.mode">
<code class="sig-name descname">mode</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.input_size">
<code class="sig-name descname">input_size</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.input_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.hidden_size">
<code class="sig-name descname">hidden_size</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.num_layers">
<code class="sig-name descname">num_layers</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.num_layers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.bias">
<code class="sig-name descname">bias</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.bias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.batch_first">
<code class="sig-name descname">batch_first</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.batch_first" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.dropout">
<code class="sig-name descname">dropout</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.dropout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.LSTM.bidirectional">
<code class="sig-name descname">bidirectional</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.LSTM.bidirectional" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.Reshape">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">Reshape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reshape_spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Reshape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Reshape module configurable by a narchi reshape_spec object.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Reshape.__init__" title="narchi.instantiators.pytorch.Reshape.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(reshape_spec)</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Reshape.forward" title="narchi.instantiators.pytorch.Reshape.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Transforms the shape of the input according to the specification in reshape_spec.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.Reshape.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reshape_spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Reshape.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Reshape.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.Reshape.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Reshape.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Reshape.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the shape of the input according to the specification in reshape_spec.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.Reshape.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.Reshape.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.Group">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">Group</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_id</span></em>, <em class="sig-param"><span class="n">blocks</span></em>, <em class="sig-param"><span class="n">blocks_mappings</span></em>, <em class="sig-param"><span class="n">module_cfg</span></em>, <em class="sig-param"><span class="n">graph</span></em>, <em class="sig-param"><span class="n">input</span></em>, <em class="sig-param"><span class="n">output</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Group" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Group module that receives narchi blocks, graph, input and output objects.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Group.__init__" title="narchi.instantiators.pytorch.Group.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(block_id, blocks, blocks_mappings, …)</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.Group.forward" title="narchi.instantiators.pytorch.Group.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Runs a forward using the group’s input and graph.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch.Group.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_id</span></em>, <em class="sig-param"><span class="n">blocks</span></em>, <em class="sig-param"><span class="n">blocks_mappings</span></em>, <em class="sig-param"><span class="n">module_cfg</span></em>, <em class="sig-param"><span class="n">graph</span></em>, <em class="sig-param"><span class="n">input</span></em>, <em class="sig-param"><span class="n">output</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Group.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Group.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch.Group.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#Group.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.Group.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a forward using the group’s input and graph.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.Group.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.Group.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="narchi.instantiators.pytorch.graph_forward">
<code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">graph_forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">module</span></em>, <em class="sig-param"><span class="n">values</span></em>, <em class="sig-param"><span class="n">out_ids</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">intermediate_outputs</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#graph_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.graph_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a forward for a module using its graph topological_predecessors.</p>
</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch.StandardModule">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch.</code><code class="sig-name descname">StandardModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">state_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch.html#StandardModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch.StandardModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule" title="narchi.instantiators.pytorch.BaseModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.instantiators.pytorch.BaseModule</span></code></a></p>
<p>Class for instantiating pytorch modules with standard block mappings.</p>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch.StandardModule.blocks_mappings" title="narchi.instantiators.pytorch.StandardModule.blocks_mappings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">blocks_mappings</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.StandardModule.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch.StandardModule.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch.StandardModule.blocks_mappings">
<code class="sig-name descname">blocks_mappings</code><em class="property"> = {'AdaptiveAvgPool1d': {'class': 'torch.nn.AdaptiveAvgPool1d', 'kwargs': {'output_size': 'output_feats'}}, 'AdaptiveAvgPool2d': {'class': 'torch.nn.AdaptiveAvgPool2d', 'kwargs': {'output_size': 'output_feats'}}, 'Add': {'class': 'narchi.instantiators.pytorch.Add'}, 'BatchNorm2d': {'class': 'torch.nn.BatchNorm2d', 'kwargs': {'num_features': 'shape:in:0'}}, 'Concatenate': {'class': 'narchi.instantiators.pytorch.Concatenate'}, 'Conv1d': {'class': 'torch.nn.Conv1d', 'kwargs': {'in_channels': 'shape:in:0', 'out_channels': 'output_feats'}}, 'Conv2d': {'class': 'torch.nn.Conv2d', 'kwargs': {'in_channels': 'shape:in:0', 'out_channels': 'output_feats'}}, 'Dropout': {'class': 'torch.nn.Dropout'}, 'Embedding': {'class': 'torch.nn.Embedding', 'kwargs': {'embedding_dim': 'output_feats'}}, 'Group': {'class': 'narchi.instantiators.pytorch.Group', 'kwargs': {'block_id': '_id'}}, 'Identity': {'class': 'torch.nn.Identity'}, 'LSTM': {'class': 'narchi.instantiators.pytorch.LSTM', 'kwargs': {':skip:': 'output_feats', 'batch_first': 'const:bool:True', 'input_size': 'shape:in:1'}}, 'LeakyReLU': {'class': 'torch.nn.LeakyReLU'}, 'Linear': {'class': 'torch.nn.Linear', 'kwargs': {'in_features': 'shape:in:-1', 'out_features': 'output_feats'}}, 'LogSoftmax': {'class': 'torch.nn.LogSoftmax'}, 'MaxPool1d': {'class': 'torch.nn.MaxPool1d'}, 'MaxPool2d': {'class': 'torch.nn.MaxPool2d'}, 'Module': {'class': 'narchi.instantiators.pytorch.StandardModule'}, 'ReLU': {'class': 'torch.nn.ReLU'}, 'Reshape': {'class': 'narchi.instantiators.pytorch.Reshape'}, 'Sequential': {'class': 'narchi.instantiators.pytorch.Sequential'}, 'Softmax': {'class': 'torch.nn.Softmax'}}</em><a class="headerlink" href="#narchi.instantiators.pytorch.StandardModule.blocks_mappings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-narchi.instantiators.pytorch_packed">
<span id="narchi-instantiators-pytorch-packed"></span><h2>narchi.instantiators.pytorch_packed<a class="headerlink" href="#module-narchi.instantiators.pytorch_packed" title="Permalink to this headline">¶</a></h2>
<p>A pytorch module instantiator that supports 1d and 2d packed sequences.</p>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseModule</span></code>(*args[, state_dict, debug])</p></td>
<td><p>Base class for instantiation of pytorch modules based on a narchi architecture.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked" title="narchi.instantiators.pytorch_packed.BatchNorm2dPacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BatchNorm2dPacked</span></code></a>(num_features[, eps, …])</p></td>
<td><p>Extension of torch.nn.BatchNorm2d that works with Packed2dSequence.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Conv2dPacked" title="narchi.instantiators.pytorch_packed.Conv2dPacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Conv2dPacked</span></code></a>(in_channels, out_channels, …)</p></td>
<td><p>Extension of torch.nn.Conv2d that works with Packed2dSequence.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.LeakyReLU2dPacked" title="narchi.instantiators.pytorch_packed.LeakyReLU2dPacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LeakyReLU2dPacked</span></code></a>(negative_slope, inplace)</p></td>
<td><p>Extension of torch.nn.LeakyReLU that works with Packed2dSequence.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Linear1dPacked" title="narchi.instantiators.pytorch_packed.Linear1dPacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Linear1dPacked</span></code></a>(in_features, out_features, bias)</p></td>
<td><p>Extension of torch.nn.Linear that works with PackedSequence.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.LogSoftmaxPacked" title="narchi.instantiators.pytorch_packed.LogSoftmaxPacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LogSoftmaxPacked</span></code></a>(dim)</p></td>
<td><p>Extension of torch.nn.LogSoftmax that works with PackedSequence.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked" title="narchi.instantiators.pytorch_packed.MaxPool2dPacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MaxPool2dPacked</span></code></a>(kernel_size, stride)</p></td>
<td><p>Extension of torch.nn.MaxPool2d that works with Packed2dSequence.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Packed2dSequence" title="narchi.instantiators.pytorch_packed.Packed2dSequence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Packed2dSequence</span></code></a>(data, lengths, gaps)</p></td>
<td><p>Named tuple for packed 2d sequences.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.PackedModule" title="narchi.instantiators.pytorch_packed.PackedModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PackedModule</span></code></a>(*args, gap_size, length_fact, …)</p></td>
<td><p>Class for instantiating pytorch modules that support 1d and 2d packed sequences.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">PackedSequence</span></code>(data[, batch_sizes, …])</p></td>
<td><p>Holds the data and list of <code class="xref py py-attr docutils literal notranslate"><span class="pre">batch_sizes</span></code> of a packed sequence.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Reshape</span></code>(reshape_spec)</p></td>
<td><p>Reshape module configurable by a narchi reshape_spec object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.ReshapePacked" title="narchi.instantiators.pytorch_packed.ReshapePacked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReshapePacked</span></code></a>(reshape_spec)</p></td>
<td><p>Reshape module that works with Packed2dSequence.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code>(x[, memo, _nil])</p></td>
<td><p>Deep copy operation on arbitrary Python objects.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">namedtuple</span></code>(typename, field_names, *[, …])</p></td>
<td><p>Returns a new subclass of tuple with named fields.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.pack_2d_sequences" title="narchi.instantiators.pytorch_packed.pack_2d_sequences"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pack_2d_sequences</span></code></a>(input[, gap_size, …])</p></td>
<td><p>Packs 3-dim tensors into a long 3-dim tensor by concatenating along the last dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.packed_2d_set_gaps_to_zero" title="narchi.instantiators.pytorch_packed.packed_2d_set_gaps_to_zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">packed_2d_set_gaps_to_zero</span></code></a>(packed)</p></td>
<td><p>Sets to zero the gap locations of a Packed2dSequence.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.packed_2d_to_1d" title="narchi.instantiators.pytorch_packed.packed_2d_to_1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">packed_2d_to_1d</span></code></a>(packed_2d)</p></td>
<td><p>Converts a Packed2dSequence to a PackedSequence.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.Packed2dSequence">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">Packed2dSequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">lengths</span></em>, <em class="sig-param"><span class="n">gaps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Packed2dSequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Packed2dSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.instantiators.pytorch_packed.Packed2dSequence" title="narchi.instantiators.pytorch_packed.Packed2dSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.instantiators.pytorch_packed.Packed2dSequence</span></code></a></p>
<p>Named tuple for packed 2d sequences.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Packed2dSequence.to" title="narchi.instantiators.pytorch_packed.Packed2dSequence.to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code></a>(*args, **kwargs)</p></td>
<td><p>Performs dtype and/or device conversion on <cite>self.data</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.Packed2dSequence.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Packed2dSequence.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Packed2dSequence.to" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs dtype and/or device conversion on <cite>self.data</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="narchi.instantiators.pytorch_packed.pack_2d_sequences">
<code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">pack_2d_sequences</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em>, <em class="sig-param"><span class="n">gap_size</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">length_fact</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">fail_if_unsorted</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#pack_2d_sequences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.pack_2d_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs 3-dim tensors into a long 3-dim tensor by concatenating along the last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>tuple/list</em><em>[</em><em>tensor</em><em>]</em>) – Input tensors to pack with shapes [C, H, Wi].</p></li>
<li><p><strong>gap_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size for gap between samples.</p></li>
<li><p><strong>length_fact</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Increase gaps so that length of inputs are multiple of length_fact.</p></li>
<li><p><strong>fail_if_unsorted</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to raise ValueError if received unsorted input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Packed2dSequence(data=tensor[1, C, H, lengths+gaps], lenghts=list[len(input)], gaps=[len(input)])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="narchi.instantiators.pytorch_packed.packed_2d_set_gaps_to_zero">
<code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">packed_2d_set_gaps_to_zero</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">packed</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#packed_2d_set_gaps_to_zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.packed_2d_set_gaps_to_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets to zero the gap locations of a Packed2dSequence.</p>
</dd></dl>

<dl class="py function">
<dt id="narchi.instantiators.pytorch_packed.packed_2d_to_1d">
<code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">packed_2d_to_1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">packed_2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#packed_2d_to_1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.packed_2d_to_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a Packed2dSequence to a PackedSequence.</p>
</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.ReshapePacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">ReshapePacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reshape_spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#ReshapePacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.ReshapePacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.instantiators.pytorch.Reshape" title="narchi.instantiators.pytorch.Reshape"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.instantiators.pytorch.Reshape</span></code></a></p>
<p>Reshape module that works with Packed2dSequence.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.ReshapePacked.forward" title="narchi.instantiators.pytorch_packed.ReshapePacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Transforms the shape of the input according to the specification in reshape_spec.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.ReshapePacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#ReshapePacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.ReshapePacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the shape of the input according to the specification in reshape_spec.</p>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.ReshapePacked.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.ReshapePacked.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">Conv2dPacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">padding</span></em>, <em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Conv2dPacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.conv.Conv2d</span></code></p>
<p>Extension of torch.nn.Conv2d that works with Packed2dSequence.</p>
<p>After convolving, the gaps are set to zero to guaranty that these values are
not considered when computing gradients or subsequent forwards.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.__init__" title="narchi.instantiators.pytorch_packed.Conv2dPacked.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(in_channels, out_channels, …[, bias])</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.forward" title="narchi.instantiators.pytorch_packed.Conv2dPacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">padding</span></em>, <em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Conv2dPacked.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Conv2dPacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.bias">
<code class="sig-name descname">bias</code><em class="property">: Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.bias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.out_channels">
<code class="sig-name descname">out_channels</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.out_channels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.kernel_size">
<code class="sig-name descname">kernel_size</code><em class="property">: Tuple<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.kernel_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.stride">
<code class="sig-name descname">stride</code><em class="property">: Tuple<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.padding">
<code class="sig-name descname">padding</code><em class="property">: Tuple<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.dilation">
<code class="sig-name descname">dilation</code><em class="property">: Tuple<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.dilation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.transposed">
<code class="sig-name descname">transposed</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.transposed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.output_padding">
<code class="sig-name descname">output_padding</code><em class="property">: Tuple<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.output_padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.padding_mode">
<code class="sig-name descname">padding_mode</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.padding_mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Conv2dPacked.weight">
<code class="sig-name descname">weight</code><em class="property">: torch.Tensor</em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Conv2dPacked.weight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">MaxPool2dPacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">stride</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#MaxPool2dPacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.pooling.MaxPool2d</span></code></p>
<p>Extension of torch.nn.MaxPool2d that works with Packed2dSequence.</p>
<p>The lengths and gaps are re-estimated.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.__init__" title="narchi.instantiators.pytorch_packed.MaxPool2dPacked.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(kernel_size, stride)</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.forward" title="narchi.instantiators.pytorch_packed.MaxPool2dPacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">stride</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#MaxPool2dPacked.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#MaxPool2dPacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked.kernel_size">
<code class="sig-name descname">kernel_size</code><em class="property">: Union<span class="p">[</span>T<span class="p">, </span>Tuple<span class="p">[</span>T<span class="p">, </span>T<span class="p">]</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.kernel_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked.stride">
<code class="sig-name descname">stride</code><em class="property">: Union<span class="p">[</span>T<span class="p">, </span>Tuple<span class="p">[</span>T<span class="p">, </span>T<span class="p">]</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked.padding">
<code class="sig-name descname">padding</code><em class="property">: Union<span class="p">[</span>T<span class="p">, </span>Tuple<span class="p">[</span>T<span class="p">, </span>T<span class="p">]</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.MaxPool2dPacked.dilation">
<code class="sig-name descname">dilation</code><em class="property">: Union<span class="p">[</span>T<span class="p">, </span>Tuple<span class="p">[</span>T<span class="p">, </span>T<span class="p">]</span><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.MaxPool2dPacked.dilation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">BatchNorm2dPacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_features</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">momentum</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">affine</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">track_running_stats</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#BatchNorm2dPacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.batchnorm.BatchNorm2d</span></code></p>
<p>Extension of torch.nn.BatchNorm2d that works with Packed2dSequence.</p>
<p>After normalization, the gaps are set to zero to guaranty that these values
are not considered when computing gradients or subsequent forwards.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.forward" title="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#BatchNorm2dPacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.num_features">
<code class="sig-name descname">num_features</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.num_features" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.eps">
<code class="sig-name descname">eps</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.eps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.momentum">
<code class="sig-name descname">momentum</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.momentum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.affine">
<code class="sig-name descname">affine</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.affine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.BatchNorm2dPacked.track_running_stats">
<code class="sig-name descname">track_running_stats</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.BatchNorm2dPacked.track_running_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.LeakyReLU2dPacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">LeakyReLU2dPacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">negative_slope</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#LeakyReLU2dPacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LeakyReLU2dPacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.activation.LeakyReLU</span></code></p>
<p>Extension of torch.nn.LeakyReLU that works with Packed2dSequence.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.forward" title="narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#LeakyReLU2dPacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.inplace">
<code class="sig-name descname">inplace</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.inplace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.negative_slope">
<code class="sig-name descname">negative_slope</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LeakyReLU2dPacked.negative_slope" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.Linear1dPacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">Linear1dPacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_features</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em>, <em class="sig-param"><span class="n">out_features</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em>, <em class="sig-param"><span class="n">bias</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Linear1dPacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Linear1dPacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.linear.Linear</span></code></p>
<p>Extension of torch.nn.Linear that works with PackedSequence.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.Linear1dPacked.forward" title="narchi.instantiators.pytorch_packed.Linear1dPacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.Linear1dPacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#Linear1dPacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Linear1dPacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Linear1dPacked.in_features">
<code class="sig-name descname">in_features</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Linear1dPacked.in_features" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Linear1dPacked.out_features">
<code class="sig-name descname">out_features</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Linear1dPacked.out_features" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.Linear1dPacked.weight">
<code class="sig-name descname">weight</code><em class="property">: torch.Tensor</em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.Linear1dPacked.weight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.LogSoftmaxPacked">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">LogSoftmaxPacked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dim</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#LogSoftmaxPacked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LogSoftmaxPacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.activation.LogSoftmax</span></code></p>
<p>Extension of torch.nn.LogSoftmax that works with PackedSequence.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.LogSoftmaxPacked.forward" title="narchi.instantiators.pytorch_packed.LogSoftmaxPacked.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.LogSoftmaxPacked.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#LogSoftmaxPacked.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LogSoftmaxPacked.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.LogSoftmaxPacked.dim">
<code class="sig-name descname">dim</code><em class="property">: Optional<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">]</span></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.LogSoftmaxPacked.dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="narchi.instantiators.pytorch_packed.PackedModule">
<em class="property">class </em><code class="sig-prename descclassname">narchi.instantiators.pytorch_packed.</code><code class="sig-name descname">PackedModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">gap_size</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">length_fact</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#PackedModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.PackedModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule" title="narchi.instantiators.pytorch.BaseModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">narchi.instantiators.pytorch.BaseModule</span></code></a></p>
<p>Class for instantiating pytorch modules that support 1d and 2d packed sequences.</p>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.PackedModule.__init__" title="narchi.instantiators.pytorch_packed.PackedModule.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(*args[, gap_size, length_fact])</p></td>
<td><p>Initializer for PackedModule class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.PackedModule.inputs_preprocess" title="narchi.instantiators.pytorch_packed.PackedModule.inputs_preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inputs_preprocess</span></code></a>(values)</p></td>
<td><p>Converts tuples of tensors into Packed2dSequence.</p></td>
</tr>
</tbody>
</table>
<p><strong>Attributes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#narchi.instantiators.pytorch_packed.PackedModule.blocks_mappings" title="narchi.instantiators.pytorch_packed.PackedModule.blocks_mappings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">blocks_mappings</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.PackedModule.blocks_mappings">
<code class="sig-name descname">blocks_mappings</code><em class="property"> = {'AdaptiveAvgPool1d': {'class': 'torch.nn.AdaptiveAvgPool1d', 'kwargs': {'output_size': 'output_feats'}}, 'AdaptiveAvgPool2d': {'class': 'torch.nn.AdaptiveAvgPool2d', 'kwargs': {'output_size': 'output_feats'}}, 'Add': {'class': 'narchi.instantiators.pytorch.Add'}, 'BatchNorm2d': {'class': 'narchi.instantiators.pytorch_packed.BatchNorm2dPacked', 'kwargs': {'num_features': 'shape:in:0'}}, 'Concatenate': {'class': 'narchi.instantiators.pytorch.Concatenate'}, 'Conv1d': {'class': 'torch.nn.Conv1d', 'kwargs': {'in_channels': 'shape:in:0', 'out_channels': 'output_feats'}}, 'Conv2d': {'class': 'narchi.instantiators.pytorch_packed.Conv2dPacked', 'kwargs': {'in_channels': 'shape:in:0', 'out_channels': 'output_feats'}}, 'Dropout': {'class': 'torch.nn.Dropout'}, 'Embedding': {'class': 'torch.nn.Embedding', 'kwargs': {'embedding_dim': 'output_feats'}}, 'Group': {'class': 'narchi.instantiators.pytorch.Group', 'kwargs': {'block_id': '_id'}}, 'Identity': {'class': 'torch.nn.Identity'}, 'LSTM': {'class': 'narchi.instantiators.pytorch.LSTM', 'kwargs': {':skip:': 'output_feats', 'batch_first': 'const:bool:True', 'input_size': 'shape:in:1'}}, 'LeakyReLU': {'class': 'narchi.instantiators.pytorch_packed.LeakyReLU2dPacked', 'kwargs': {'inplace': 'const:bool:True'}}, 'Linear': {'class': 'narchi.instantiators.pytorch_packed.Linear1dPacked', 'kwargs': {'in_features': 'shape:in:-1', 'out_features': 'output_feats'}}, 'LogSoftmax': {'class': 'narchi.instantiators.pytorch_packed.LogSoftmaxPacked'}, 'MaxPool1d': {'class': 'torch.nn.MaxPool1d'}, 'MaxPool2d': {'class': 'narchi.instantiators.pytorch_packed.MaxPool2dPacked'}, 'Module': {'class': 'narchi.instantiators.pytorch.StandardModule'}, 'ReLU': {'class': 'torch.nn.ReLU'}, 'Reshape': {'class': 'narchi.instantiators.pytorch_packed.ReshapePacked'}, 'Sequential': {'class': 'narchi.instantiators.pytorch.Sequential'}, 'Softmax': {'class': 'torch.nn.Softmax'}}</em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.PackedModule.blocks_mappings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.PackedModule.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">gap_size</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">length_fact</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#PackedModule.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.PackedModule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializer for PackedModule class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gap_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size for gap between samples.</p></li>
<li><p><strong>length_fact</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Increase gaps so that length of inputs are multiple of length_fact.</p></li>
<li><p><strong>args/kwargs</strong> – All other arguments accepted by <a class="reference internal" href="#narchi.instantiators.pytorch.BaseModule" title="narchi.instantiators.pytorch.BaseModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModule</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="narchi.instantiators.pytorch_packed.PackedModule.inputs_preprocess">
<code class="sig-name descname">inputs_preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/narchi/instantiators/pytorch_packed.html#PackedModule.inputs_preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#narchi.instantiators.pytorch_packed.PackedModule.inputs_preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts tuples of tensors into Packed2dSequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>values</strong> (<em>OrderedDict</em>) – Inputs to the module.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="narchi.instantiators.pytorch_packed.PackedModule.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#narchi.instantiators.pytorch_packed.PackedModule.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="cmd.html" class="btn btn-neutral float-left" title="Command line tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-present, Mauricio Villegas

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>